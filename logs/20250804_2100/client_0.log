2025-08-04 21:00:02,085 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:02,085 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:00:02,085 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:00:02,085 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:00:02,085 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:00:02,086 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:02,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:02,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:02,433 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:00:02,447 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:00:02,447 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:02,680 - ClientAppLogger [Client 0] - INFO - Global hold-out test set with 31657 samples saved to /app/logs/20250804_2100/holdout_test_set.csv
2025-08-04 21:00:02,725 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:02,730 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:02,730 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:02,743 - ClientAppLogger [Client 0] - INFO - Scaler object saved by client 0 to /app/logs/20250804_2100/min_max_scaler.pkl
2025-08-04 21:00:02,744 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:00:02,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:02,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:00:02,750 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:02,750 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:02,750 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:00:02,758 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:02,761 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:02,763 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:02,765 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:02,768 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:02,771 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:02,773 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:02,776 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:02,779 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:02,781 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:02,783 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:02,795 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:02,795 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:00:02,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:00:02,800 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:00:02,805 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:02,806 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:00:02,814 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:02,814 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:00:02,815 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:02,831 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:02,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:00:02,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:00:02,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:02,841 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:02,842 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:02,842 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:02,842 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:02,843 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:00:02,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:02,843 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:00:02,843 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:02,844 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:00:02,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:00:02,845 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:02,845 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:00:02,845 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:02,846 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:02,846 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:02,846 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:00:02,846 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:00:02,847 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:00:02,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:00:02,847 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:00:02,847 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:00:02,848 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:00:02,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:00:02,848 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:00:02,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:00:02,849 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:00:02,849 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:00:02,849 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:02,849 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:00:02,849 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:02,850 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:02,850 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:02,850 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:00:02,850 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:00:02,850 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:00:02,850 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:00:02,855 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:00:02,855 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:02,856 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:02,856 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:00:02,858 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 158/400.
2025-08-04 21:00:02,959 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:02,959 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:02,960 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 21:00:02,961 - ClientAppLogger [Client 0] - INFO - [Client] Round 158: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 21:00:02,961 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:02,987 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0745, Avg D Loss: 0.7849
2025-08-04 21:00:02,987 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0745, Avg D Loss: 0.7849
2025-08-04 21:00:02,987 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:03,000 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4997, Threshold=0.5167, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:00:03,000 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:00:03,000 - ClientAppLogger [Client 0] - INFO - Fit completed for round 158. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 158, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0744929552078246, 'd_loss': 0.7849329233169555, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14215397834777832, 'cpu_percent_fit': 6.05625, 'ram_mb_fit': 7.171875, 'accumulated_train_samples_this_round': 32}
2025-08-04 21:00:03,001 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:00:17,274 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:17,274 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:00:17,274 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:00:17,274 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:00:17,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:00:17,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:17,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:17,647 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:17,737 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:00:17,791 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:00:17,791 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:17,966 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:17,973 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:17,973 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:17,981 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:00:17,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:17,987 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:00:17,988 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:17,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:17,988 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:00:17,997 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:18,000 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:18,002 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:18,005 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:18,008 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:18,010 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:18,013 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:18,015 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:18,018 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:18,020 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:18,023 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:18,033 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:18,034 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:00:18,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:00:18,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:00:18,047 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:18,048 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:00:18,063 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:18,064 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:00:18,064 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:18,079 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:18,084 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:00:18,092 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:00:18,092 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:18,092 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:18,092 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:18,093 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:18,093 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:18,093 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:00:18,093 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:18,094 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:00:18,094 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:18,095 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:00:18,095 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:00:18,096 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:18,096 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:00:18,096 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:18,096 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:00:18,097 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:00:18,098 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:00:18,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:00:18,098 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:00:18,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:00:18,098 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:00:18,098 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:00:18,099 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:18,099 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:00:18,099 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:18,099 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:18,100 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:18,100 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:00:18,100 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:00:18,100 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:00:18,101 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:00:18,110 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:00:18,110 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:18,111 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:18,111 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:00:18,113 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:18,113 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:18,113 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:18,114 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:18,128 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5347, Threshold=0.5733, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:00:18,129 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5347
2025-08-04 21:00:26,381 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:26,381 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:00:26,381 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:00:26,381 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:00:26,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:00:26,381 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:26,725 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:26,726 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:26,812 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:00:26,834 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:00:26,834 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:26,937 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:26,943 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:26,943 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:26,947 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:00:26,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:26,953 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:00:26,953 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:26,954 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:26,954 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:00:26,962 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:26,965 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:26,967 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:26,969 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:26,972 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:26,974 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:26,977 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:26,979 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:26,982 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:26,984 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:26,986 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:26,995 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:26,995 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:00:27,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:00:27,000 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:00:27,005 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:27,005 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:00:27,014 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:27,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:00:27,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:27,029 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:27,033 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:00:27,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:00:27,037 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:27,037 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:27,038 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:27,038 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:27,038 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:27,038 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:00:27,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:27,039 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:00:27,039 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:27,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:00:27,040 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:00:27,040 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:00:27,041 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:00:27,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:00:27,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:00:27,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:00:27,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:00:27,042 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:00:27,042 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:00:27,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:00:27,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:00:27,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:00:27,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:27,043 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:00:27,043 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:27,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:27,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:27,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:00:27,044 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:00:27,044 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:00:27,044 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:00:27,049 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:00:27,049 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:27,050 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:27,050 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:00:27,052 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 159/400.
2025-08-04 21:00:27,153 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:27,153 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:27,154 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 21:00:27,155 - ClientAppLogger [Client 0] - INFO - [Client] Round 159: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 21:00:27,155 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:27,180 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0789, Avg D Loss: 0.7809
2025-08-04 21:00:27,180 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0789, Avg D Loss: 0.7809
2025-08-04 21:00:27,180 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:27,194 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5026, Threshold=0.5248, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:00:27,194 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:00:27,194 - ClientAppLogger [Client 0] - INFO - Fit completed for round 159. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 159, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.07894024848938, 'd_loss': 0.7809185981750488, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14215874671936035, 'cpu_percent_fit': 6.1125, 'ram_mb_fit': 1.6015625, 'accumulated_train_samples_this_round': 32}
2025-08-04 21:00:27,194 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:00:41,488 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:41,488 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:00:41,489 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:00:41,489 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:00:41,489 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:00:41,489 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:41,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:41,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:41,999 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:00:42,045 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:00:42,046 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:42,187 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:42,194 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:42,194 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:42,200 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:00:42,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:42,208 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:00:42,209 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:42,209 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:42,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:00:42,220 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:42,223 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:42,225 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:42,228 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:42,231 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:42,233 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:42,236 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:42,238 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:42,241 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:42,243 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:42,245 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:42,256 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:42,256 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:00:42,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:00:42,261 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:00:42,265 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:42,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:00:42,274 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:42,274 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:00:42,275 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:42,291 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:42,296 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:00:42,302 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:00:42,302 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:42,302 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:42,302 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:42,303 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:42,303 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:42,303 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:00:42,303 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:42,303 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:00:42,303 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:42,305 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:00:42,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:00:42,305 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:42,305 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:00:42,306 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:00:42,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:00:42,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:00:42,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:00:42,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:00:42,307 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:00:42,307 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:00:42,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:00:42,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:42,308 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:00:42,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:42,308 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:42,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:42,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:00:42,309 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:00:42,309 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:00:42,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:00:42,313 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:00:42,313 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:42,314 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:42,315 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:00:42,316 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:42,316 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:42,316 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:42,317 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:42,333 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5204, Threshold=0.5488, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:00:42,334 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5204
2025-08-04 21:00:50,598 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:50,598 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:00:50,598 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:00:50,598 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:00:50,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:00:50,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:50,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:50,937 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:51,026 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:00:51,050 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:00:51,050 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:51,154 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:51,160 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:51,160 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:51,166 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:00:51,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:51,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:00:51,172 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:51,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:51,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:00:51,181 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:51,184 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:51,187 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:51,189 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:51,192 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:51,195 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:51,198 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:51,201 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:51,204 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:51,206 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:51,209 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:51,218 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:51,218 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:00:51,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:00:51,223 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:00:51,229 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:51,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:00:51,239 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:51,240 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:00:51,240 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:51,255 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:51,259 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:00:51,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:00:51,264 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:51,264 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:51,264 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:51,264 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:51,265 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:51,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:00:51,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:51,265 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:00:51,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:51,267 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:00:51,267 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:00:51,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:51,268 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:00:51,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:51,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:51,268 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:51,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:00:51,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:00:51,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:00:51,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:00:51,269 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:00:51,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:00:51,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:00:51,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:00:51,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:00:51,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:00:51,270 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:00:51,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:00:51,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:51,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:00:51,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:51,271 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:51,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:51,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:00:51,272 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:00:51,272 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:00:51,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:00:51,277 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:00:51,277 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:51,278 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:51,278 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:00:51,280 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 160/400.
2025-08-04 21:00:51,381 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:51,381 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:51,382 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 21:00:51,383 - ClientAppLogger [Client 0] - INFO - [Client] Round 160: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 21:00:51,383 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:51,409 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0742, Avg D Loss: 0.7816
2025-08-04 21:00:51,409 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0742, Avg D Loss: 0.7816
2025-08-04 21:00:51,410 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:51,424 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5217, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:00:51,424 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:00:51,424 - ClientAppLogger [Client 0] - INFO - Fit completed for round 160. Duration: 0.14s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 160, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.074158024787903, 'd_loss': 0.7815830051898957, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.14427995681762695, 'cpu_percent_fit': 7.225, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 32}
2025-08-04 21:00:51,424 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:01:02,719 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:02,719 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:01:02,719 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:01:02,719 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:01:02,720 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:01:02,720 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:03,136 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:03,136 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:03,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:01:03,278 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:01:03,279 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:03,449 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:03,456 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:03,456 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:03,461 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:01:03,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:03,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:01:03,468 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:03,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:03,469 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:01:03,478 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:03,482 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:03,484 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:03,486 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:03,489 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:03,492 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:03,494 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:03,497 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:03,500 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:03,502 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:03,505 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:03,514 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:03,515 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:01:03,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:01:03,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:01:03,525 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:03,525 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:01:03,535 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:03,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:01:03,535 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:03,551 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:03,556 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:01:03,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:01:03,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:03,568 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:03,568 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:03,568 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:03,568 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:03,569 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:01:03,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:03,569 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:01:03,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:03,571 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:01:03,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:01:03,571 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:03,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:01:03,571 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:03,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:03,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:03,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:01:03,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:01:03,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:01:03,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:01:03,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:01:03,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:01:03,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:03,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:01:03,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:03,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:03,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:03,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:01:03,575 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:01:03,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:01:03,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:01:03,584 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:01:03,584 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:03,586 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:03,586 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:01:03,587 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:03,587 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:03,588 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:03,589 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:03,605 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5381, Threshold=0.5683, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:01:03,605 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5381
2025-08-04 21:01:08,870 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:08,870 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:01:08,870 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:01:08,870 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:01:08,871 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:01:08,871 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:09,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:09,210 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:09,292 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:01:09,325 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:01:09,325 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:09,411 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:09,416 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:09,416 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:09,422 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:01:09,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:09,475 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:01:09,476 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:09,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:09,476 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:01:09,485 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:09,488 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:09,490 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:09,493 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:09,495 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:09,497 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:09,500 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:09,503 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:09,506 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:09,508 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:09,510 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:09,520 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:09,520 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:01:09,525 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:01:09,525 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:01:09,530 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:09,531 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:01:09,541 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:09,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:01:09,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:09,558 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:09,564 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:01:09,570 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:01:09,570 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:09,570 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:09,570 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:09,570 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:09,571 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:09,571 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:01:09,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:09,571 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:01:09,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:09,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:01:09,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:01:09,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:09,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:01:09,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:01:09,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:01:09,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:01:09,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:01:09,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:01:09,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:01:09,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:01:09,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:01:09,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:01:09,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:09,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:01:09,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:09,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:09,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:09,577 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:01:09,577 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:01:09,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:01:09,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:01:09,585 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:01:09,585 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:09,587 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:09,587 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:01:09,588 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 161/400.
2025-08-04 21:01:09,689 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:09,689 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:09,691 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 21:01:09,691 - ClientAppLogger [Client 0] - INFO - [Client] Round 161: Training GAN with 33 samples (26 normal, 7 anomalous).
2025-08-04 21:01:09,691 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:09,737 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0787, Avg D Loss: 0.7906
2025-08-04 21:01:09,738 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0787, Avg D Loss: 0.7906
2025-08-04 21:01:09,738 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:09,751 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4804, Threshold=0.4871, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:01:09,751 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:01:09,751 - ClientAppLogger [Client 0] - INFO - Fit completed for round 161. Duration: 0.16s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 161, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.078744699015762, 'd_loss': 0.7905959349690062, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.1627967357635498, 'cpu_percent_fit': 6.05625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 33}
2025-08-04 21:01:09,751 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:01:24,029 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:24,030 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:01:24,030 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:01:24,030 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:01:24,030 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:01:24,030 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:24,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:24,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:24,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:01:24,456 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:01:24,456 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:24,556 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:24,563 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:24,563 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:24,568 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:01:24,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:24,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:01:24,575 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:24,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:24,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:01:24,584 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:24,587 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:24,590 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:24,592 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:24,595 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:24,598 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:24,600 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:24,603 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:24,606 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:24,608 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:24,611 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:24,623 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:24,623 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:01:24,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:01:24,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:01:24,635 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:24,636 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:01:24,651 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:24,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:01:24,653 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:24,672 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:24,678 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:01:24,688 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:01:24,688 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:24,688 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:24,688 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:24,689 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:24,689 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:24,689 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:01:24,690 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:24,690 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:01:24,691 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:24,692 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:01:24,692 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:01:24,693 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:24,693 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:01:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:01:24,694 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:01:24,694 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:01:24,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:01:24,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:01:24,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:01:24,695 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:01:24,695 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:01:24,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:01:24,696 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:01:24,696 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:01:24,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:01:24,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:24,697 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:01:24,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:24,697 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:24,698 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:24,698 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:01:24,698 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:01:24,699 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:01:24,699 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:01:24,703 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:01:24,704 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:24,705 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:24,705 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:01:24,707 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:24,707 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:24,707 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:24,708 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:24,725 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5098, Threshold=0.5309, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:01:24,725 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5098
2025-08-04 21:01:36,030 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:36,030 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:01:36,031 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:01:36,031 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:01:36,031 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:01:36,031 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:36,460 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:36,460 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:36,552 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:01:36,599 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:01:36,599 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:36,758 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:36,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:36,765 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:36,773 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:01:36,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:36,782 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:01:36,783 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:36,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:36,783 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:01:36,793 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:36,797 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:36,799 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:36,801 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:36,804 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:36,806 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:36,809 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:36,812 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:36,816 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:36,818 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:36,821 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:36,835 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:36,835 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:01:36,840 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:01:36,841 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:01:36,848 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:36,848 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:01:36,863 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:36,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:01:36,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:36,882 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:36,887 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:01:36,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:01:36,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:36,894 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:36,894 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:36,895 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:36,895 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:36,895 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:01:36,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:36,896 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:01:36,896 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:36,898 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:01:36,898 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:01:36,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:36,899 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:01:36,899 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:36,900 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:36,901 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:36,901 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:01:36,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:01:36,902 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:01:36,902 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:01:36,903 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:01:36,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:01:36,903 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:01:36,903 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:01:36,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:01:36,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:01:36,904 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:01:36,904 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:01:36,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:36,905 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:01:36,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:36,905 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:36,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:36,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:01:36,906 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:01:36,906 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:01:36,906 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:01:36,912 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:01:36,912 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:36,914 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:36,914 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:01:36,916 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:36,916 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:36,916 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:36,917 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:36,931 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5604, Threshold=0.6261, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:01:36,932 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5604
2025-08-04 21:01:48,199 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:48,199 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:01:48,200 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:01:48,200 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:01:48,200 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:01:48,200 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:48,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:48,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:48,661 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:01:48,706 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:01:48,706 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:48,869 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:48,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:48,877 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:48,884 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:01:48,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:48,894 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:01:48,895 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:48,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:48,895 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:01:48,906 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:48,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:48,912 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:48,914 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:48,917 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:48,920 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:48,923 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:48,926 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:48,929 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:48,931 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:48,933 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:48,945 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:48,945 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:01:48,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:01:48,950 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:01:48,959 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:48,959 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:01:48,976 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:48,976 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:01:48,977 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:48,997 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:49,003 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:01:49,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:01:49,009 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:49,009 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:49,009 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:49,010 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:49,010 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:49,010 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:01:49,010 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:49,011 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:01:49,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:49,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:01:49,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:01:49,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:49,013 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:01:49,013 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:49,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:49,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:49,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:01:49,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:01:49,014 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:01:49,014 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:01:49,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:01:49,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:01:49,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:01:49,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:01:49,015 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:01:49,015 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:01:49,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:01:49,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:01:49,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:49,016 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:01:49,016 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:49,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:49,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:49,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:01:49,017 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:01:49,017 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:01:49,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:01:49,023 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:01:49,024 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:49,025 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:49,025 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:01:49,027 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:49,027 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:49,027 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:49,028 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:49,043 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4969, Threshold=0.5043, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:01:49,043 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4969
2025-08-04 21:01:54,309 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:54,309 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:01:54,309 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:01:54,309 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:01:54,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:01:54,310 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:54,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:54,682 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:54,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:01:54,776 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:01:54,776 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:54,863 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:54,869 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:54,869 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:54,874 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:01:54,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:54,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:01:54,880 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:54,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:54,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:01:54,889 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:54,892 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:54,894 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:54,896 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:54,898 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:54,900 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:54,903 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:54,905 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:54,907 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:54,909 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:54,912 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:54,920 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:54,920 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:01:54,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:01:54,925 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:01:54,929 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:54,929 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:01:54,938 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:54,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:01:54,939 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:54,953 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:54,957 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:01:54,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:01:54,962 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:54,962 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:54,962 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:54,963 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:54,963 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:54,963 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:01:54,963 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:54,963 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:01:54,964 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:54,965 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:01:54,965 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:01:54,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:54,966 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:01:54,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:54,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:54,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:54,966 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:01:54,967 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:01:54,968 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:54,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:54,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:54,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:01:54,969 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:01:54,969 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:01:54,969 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:01:54,974 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:01:54,974 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:54,976 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:54,976 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:01:54,977 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 164/400.
2025-08-04 21:01:55,079 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:55,079 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:55,080 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 21:01:55,081 - ClientAppLogger [Client 0] - INFO - [Client] Round 164: Training GAN with 33 samples (26 normal, 7 anomalous).
2025-08-04 21:01:55,081 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:55,128 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7921
2025-08-04 21:01:55,128 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7921
2025-08-04 21:01:55,128 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:55,141 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4726, Threshold=0.4738, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:01:55,141 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:01:55,141 - ClientAppLogger [Client 0] - INFO - Fit completed for round 164. Duration: 0.16s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 164, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.084749658902486, 'd_loss': 0.7921419931180549, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.16382384300231934, 'cpu_percent_fit': 6.0, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 33}
2025-08-04 21:01:55,141 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:02:09,416 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:09,417 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:02:09,417 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:02:09,417 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:02:09,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:02:09,417 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:09,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:09,866 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:09,989 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:02:10,038 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:02:10,038 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:10,182 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:10,192 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:10,192 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:10,204 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:02:10,224 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:10,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:02:10,228 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:10,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:10,229 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:02:10,245 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:10,248 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,251 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:10,255 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:10,259 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:10,261 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:10,266 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,271 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:10,274 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:10,276 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:10,279 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:10,290 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:10,290 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:02:10,295 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:02:10,295 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:02:10,300 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:10,301 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:02:10,315 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:10,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:02:10,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:10,333 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:10,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:02:10,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:02:10,349 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:10,349 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:10,350 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:10,351 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:10,352 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:10,352 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:02:10,352 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:10,353 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:02:10,353 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:10,356 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:02:10,356 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:02:10,357 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:10,357 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:02:10,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:10,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:10,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:10,358 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:02:10,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:02:10,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:02:10,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:02:10,359 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:02:10,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:02:10,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:02:10,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:02:10,360 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:02:10,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:02:10,361 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:02:10,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:02:10,361 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:10,361 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:02:10,362 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:10,362 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:10,362 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:10,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:02:10,363 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:02:10,363 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:02:10,363 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:02:10,370 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:02:10,370 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:10,372 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:10,372 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:02:10,374 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:10,374 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:10,374 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:10,375 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:10,396 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5371, Threshold=0.5774, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 21:02:10,396 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.5371
2025-08-04 21:02:15,650 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:15,650 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:02:15,650 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:02:15,650 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:02:15,650 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:02:15,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:15,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:15,994 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:16,076 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:02:16,090 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:02:16,090 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:16,199 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:16,206 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:16,207 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:16,215 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:02:16,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:16,221 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:02:16,222 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:16,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:16,222 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:02:16,231 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:16,234 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:16,236 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:16,238 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:16,241 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:16,243 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:16,246 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:16,248 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:16,251 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:16,253 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:16,256 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:16,266 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:16,266 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:02:16,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:02:16,271 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:02:16,276 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:16,276 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:02:16,286 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:16,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:02:16,286 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:16,301 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:16,306 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:02:16,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:02:16,311 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:16,311 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:16,311 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:16,312 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:16,312 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:16,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:02:16,312 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:16,312 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:02:16,313 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:16,314 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:02:16,314 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:02:16,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:16,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:02:16,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:16,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:16,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:16,315 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:02:16,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:02:16,317 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:02:16,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:02:16,317 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:02:16,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:02:16,317 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:16,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:02:16,318 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:16,318 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:16,318 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:16,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:02:16,319 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:02:16,319 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:02:16,319 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:02:16,324 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:02:16,324 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:16,325 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:16,326 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:02:16,327 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 165/400.
2025-08-04 21:02:16,428 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:16,429 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:16,441 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:02:16,441 - ClientAppLogger [Client 0] - INFO - [Client] Round 165: Training GAN with 35 samples (27 normal, 8 anomalous).
2025-08-04 21:02:16,442 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:16,496 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0885, Avg D Loss: 0.7990
2025-08-04 21:02:16,497 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0885, Avg D Loss: 0.7990
2025-08-04 21:02:16,497 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:16,512 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3719, Threshold=0.3346, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:02:16,512 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:02:16,512 - ClientAppLogger [Client 0] - INFO - Fit completed for round 165. Duration: 0.19s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 165, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0885423340116227, 'd_loss': 0.7989961201804024, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.18512201309204102, 'cpu_percent_fit': 5.2, 'ram_mb_fit': 3.6171875, 'accumulated_train_samples_this_round': 35}
2025-08-04 21:02:16,513 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:02:30,786 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:30,786 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:02:30,786 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:02:30,786 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:02:30,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:02:30,787 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:31,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:31,241 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:31,345 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:02:31,411 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:02:31,411 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:31,595 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:31,605 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:31,606 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:31,613 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:02:31,704 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:31,747 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:02:31,748 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:31,748 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:31,749 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:02:31,762 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:31,765 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:31,768 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:31,772 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:31,775 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:31,778 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:31,780 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:31,783 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:31,786 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:31,788 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:31,791 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:31,803 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:31,803 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:02:31,809 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:02:31,809 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:02:31,819 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:31,819 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:02:31,837 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:31,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:02:31,837 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:31,858 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:31,864 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:02:31,871 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:02:31,871 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:31,871 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:31,871 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:31,872 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:31,872 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:31,873 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:02:31,873 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:31,873 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:02:31,873 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:31,875 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:02:31,875 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:02:31,875 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:31,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:02:31,876 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:31,876 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:31,876 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:31,876 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:02:31,876 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:02:31,877 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:02:31,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:02:31,877 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:02:31,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:02:31,877 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:02:31,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:02:31,878 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:02:31,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:02:31,878 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:02:31,878 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:02:31,879 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:31,879 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:02:31,879 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:31,880 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:31,880 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:31,880 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:02:31,881 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:02:31,881 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:02:31,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:02:31,892 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:02:31,892 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:31,894 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:31,894 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:02:31,896 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:31,896 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:31,896 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:31,897 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:31,913 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5486, Threshold=0.5924, Accuracy=0.7165, F1=0.8053, Precision=0.9768, Recall=0.6850
2025-08-04 21:02:31,913 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7165, F1: 0.8053, Prec: 0.9768, Rec: 0.6850, Avg Anomaly Score: 0.5486
2025-08-04 21:02:37,172 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:37,172 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:02:37,172 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:02:37,172 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:02:37,172 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:02:37,173 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:37,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:37,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:37,628 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:02:37,654 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:02:37,654 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:37,793 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:37,801 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:37,801 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:37,807 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:02:37,814 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:37,814 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:02:37,814 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:37,815 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:37,815 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:02:37,824 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:37,827 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:37,829 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:37,831 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:37,834 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:37,836 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:37,839 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:37,842 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:37,845 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:37,847 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:37,849 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:37,860 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:37,860 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:02:37,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:02:37,865 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:02:37,870 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:37,870 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:02:37,880 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:37,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:02:37,881 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:37,896 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:37,901 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:02:37,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:02:37,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:37,907 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:37,907 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:37,907 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:37,908 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:37,908 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:02:37,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:37,908 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:02:37,908 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:37,910 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:02:37,910 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:02:37,910 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:37,910 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:02:37,911 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:37,911 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:37,911 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:37,911 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:02:37,911 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:02:37,911 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:02:37,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:02:37,912 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:02:37,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:02:37,912 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:02:37,912 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:02:37,912 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:02:37,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:02:37,913 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:02:37,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:02:37,913 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:37,913 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:02:37,913 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:37,914 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:37,914 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:37,914 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:02:37,914 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:02:37,914 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:02:37,914 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:02:37,919 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:02:37,919 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:37,920 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:37,921 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:02:37,922 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 166/400.
2025-08-04 21:02:38,031 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:38,031 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:38,044 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:02:38,045 - ClientAppLogger [Client 0] - INFO - [Client] Round 166: Training GAN with 35 samples (27 normal, 8 anomalous).
2025-08-04 21:02:38,046 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:38,102 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0754, Avg D Loss: 0.7899
2025-08-04 21:02:38,103 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0754, Avg D Loss: 0.7899
2025-08-04 21:02:38,103 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:38,116 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5185, Threshold=0.5537, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 21:02:38,117 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8076
2025-08-04 21:02:38,117 - ClientAppLogger [Client 0] - INFO - Fit completed for round 166. Duration: 0.19s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 166, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0754095622471396, 'd_loss': 0.7898765552043915, 'post_fit_local_f1': 0.8076463560334528, 'fit_time_seconds': 0.19434475898742676, 'cpu_percent_fit': 5.1125, 'ram_mb_fit': 5.87109375, 'accumulated_train_samples_this_round': 35}
2025-08-04 21:02:38,117 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:02:52,435 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:52,436 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:02:52,436 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:02:52,436 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:02:52,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:02:52,436 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:52,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:52,996 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:53,104 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:02:53,153 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:02:53,153 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:53,350 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:53,360 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:53,360 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:53,371 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:02:53,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:53,382 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:02:53,383 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:53,384 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:53,384 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:02:53,396 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:53,400 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,404 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:53,408 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:53,412 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:53,415 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:53,419 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,422 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:53,426 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:53,429 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:53,432 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:53,445 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:53,445 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:02:53,451 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:02:53,451 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:02:53,458 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,458 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:02:53,477 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:02:53,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:53,505 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:53,513 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:02:53,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:02:53,528 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:53,528 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:53,528 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:53,529 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:53,529 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:53,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:02:53,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:53,530 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:02:53,530 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:53,532 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:02:53,533 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:02:53,534 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:53,537 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:02:53,538 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:53,538 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:53,539 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:53,540 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:02:53,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:02:53,540 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:02:53,540 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:02:53,540 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:02:53,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:02:53,541 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:02:53,541 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:02:53,541 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:02:53,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:02:53,542 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:02:53,542 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:02:53,543 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:53,543 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:02:53,543 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:53,543 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:53,544 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:53,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:02:53,544 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:02:53,544 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:02:53,545 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:02:53,552 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:02:53,553 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:53,555 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:53,556 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:02:53,558 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:53,558 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:53,558 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:53,559 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:53,583 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4992, Threshold=0.5083, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:02:53,585 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4992
2025-08-04 21:02:58,876 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:58,877 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:02:58,877 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:02:58,877 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:02:58,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:02:58,877 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:59,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:59,339 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:59,440 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:02:59,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:02:59,491 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:59,646 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:59,651 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:59,651 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:59,657 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:02:59,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:59,664 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:02:59,665 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:59,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:59,665 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:02:59,675 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:59,678 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:59,681 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:59,683 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:59,686 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:59,688 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:59,691 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:59,694 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:59,697 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:59,699 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:59,701 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:59,712 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:59,712 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:02:59,717 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:02:59,717 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:02:59,722 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:59,722 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:02:59,732 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:59,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:02:59,733 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:59,750 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:59,755 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:02:59,761 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:02:59,762 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:59,762 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:59,762 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:59,762 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:59,763 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:59,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:02:59,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:59,763 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:02:59,763 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:59,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:02:59,765 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:02:59,765 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:59,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:02:59,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:59,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:59,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:59,766 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:02:59,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:02:59,767 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:02:59,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:02:59,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:02:59,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:59,768 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:02:59,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:59,768 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:59,769 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:59,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:02:59,769 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:02:59,769 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:02:59,769 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:02:59,777 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:02:59,778 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:59,779 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:59,779 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:02:59,780 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 167/400.
2025-08-04 21:02:59,881 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:59,882 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:59,883 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:02:59,883 - ClientAppLogger [Client 0] - INFO - [Client] Round 167: Training GAN with 35 samples (27 normal, 8 anomalous).
2025-08-04 21:02:59,884 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:59,932 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0877, Avg D Loss: 0.8005
2025-08-04 21:02:59,933 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0877, Avg D Loss: 0.8005
2025-08-04 21:02:59,933 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:59,947 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.3717, Threshold=0.3266, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:02:59,947 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:02:59,947 - ClientAppLogger [Client 0] - INFO - Fit completed for round 167. Duration: 0.17s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 167, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0877103689738683, 'd_loss': 0.8005401870182581, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.16678690910339355, 'cpu_percent_fit': 5.7, 'ram_mb_fit': 6.6328125, 'accumulated_train_samples_this_round': 35}
2025-08-04 21:02:59,947 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:03:14,271 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:14,271 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:03:14,272 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:03:14,272 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:03:14,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:03:14,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:14,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:14,941 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:15,071 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:03:15,128 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:03:15,129 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:15,304 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:15,315 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:15,315 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:15,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:03:15,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:15,358 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:03:15,359 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:15,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:15,359 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:03:15,373 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:15,377 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,380 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:15,383 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:15,387 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:15,390 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:15,395 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,398 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:15,402 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:15,405 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:15,408 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:15,420 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:15,421 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:03:15,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:03:15,426 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:03:15,434 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:15,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:03:15,454 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:15,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:03:15,455 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:15,479 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:15,488 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:03:15,497 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:03:15,501 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:15,501 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:15,501 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:15,502 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:15,502 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:15,502 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:03:15,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:15,503 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:03:15,503 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:15,505 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:03:15,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:03:15,506 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:15,507 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:03:15,507 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:15,508 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:15,508 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:15,509 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:03:15,509 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:03:15,510 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:03:15,510 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:03:15,511 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:03:15,512 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:03:15,513 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:03:15,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:03:15,514 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:03:15,514 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:03:15,515 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:03:15,515 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:03:15,515 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:15,516 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:03:15,517 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:15,517 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:15,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:15,518 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:03:15,518 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:03:15,518 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:03:15,519 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:03:15,530 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:03:15,530 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:15,532 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:15,532 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:03:15,534 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:15,534 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:15,534 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:15,535 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:15,556 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5515, Threshold=0.5867, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 21:03:15,556 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.5515
2025-08-04 21:03:20,835 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:20,835 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:03:20,836 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:03:20,836 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:03:20,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:03:20,836 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:21,225 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:21,226 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:21,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:03:21,350 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:03:21,350 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:21,462 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:21,468 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:21,468 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:21,474 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:03:21,494 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:21,494 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:03:21,495 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:21,495 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:21,495 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:03:21,505 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:21,507 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:21,510 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:21,512 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:21,514 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:21,517 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:21,519 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:21,522 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:21,525 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:21,527 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:21,529 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:21,538 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:21,539 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:03:21,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:03:21,544 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:03:21,550 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:21,550 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:03:21,561 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:21,561 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:03:21,561 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:21,577 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:21,581 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:03:21,586 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:03:21,586 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:21,586 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:21,587 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:21,587 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:21,587 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:21,587 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:03:21,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:21,588 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:03:21,588 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:21,589 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:03:21,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:03:21,590 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:21,590 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:03:21,590 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:21,590 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:21,590 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:03:21,591 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:03:21,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:03:21,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:03:21,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:03:21,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:03:21,592 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:03:21,592 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:21,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:03:21,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:21,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:21,593 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:21,593 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:03:21,593 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:03:21,594 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:03:21,594 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:03:21,603 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:03:21,603 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:21,604 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:21,604 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:03:21,606 - ClientAppLogger [Client 0] - INFO - [Client] Fit started for round 168/400.
2025-08-04 21:03:21,707 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:21,707 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:21,709 - ClientAppLogger [Client 0] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:03:21,709 - ClientAppLogger [Client 0] - INFO - [Client] Round 168: Training GAN with 35 samples (27 normal, 8 anomalous).
2025-08-04 21:03:21,709 - ClientAppLogger [Client 0] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:21,756 - ClientAppLogger [Client 0] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0772, Avg D Loss: 0.7944
2025-08-04 21:03:21,757 - ClientAppLogger [Client 0] - INFO - GAN Training completed. Avg G Loss: 2.0772, Avg D Loss: 0.7944
2025-08-04 21:03:21,757 - ClientAppLogger [Client 0] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:21,771 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5239, Threshold=0.5790, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:03:21,771 - ClientAppLogger [Client 0] - INFO - [Client] Post-fit local evaluation F1: 0.8124
2025-08-04 21:03:21,772 - ClientAppLogger [Client 0] - INFO - Fit completed for round 168. Duration: 0.17s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '0', 'server_round': 168, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.077181409427098, 'd_loss': 0.7944260166372572, 'post_fit_local_f1': 0.8124253285543608, 'fit_time_seconds': 0.16618752479553223, 'cpu_percent_fit': 6.75, 'ram_mb_fit': 6.96875, 'accumulated_train_samples_this_round': 35}
2025-08-04 21:03:21,772 - ClientAppLogger [Client 0] - INFO - [Client] get_parameters called
2025-08-04 21:03:33,125 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:33,126 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:03:33,126 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:03:33,126 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:03:33,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:03:33,126 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:33,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:33,676 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,778 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:03:33,794 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:03:33,794 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:33,901 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:33,909 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:33,909 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:33,914 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:03:33,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:33,921 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:03:33,921 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:33,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:33,922 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:03:33,931 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:33,934 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,936 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:33,939 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:33,943 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:33,945 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:33,948 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,951 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:33,954 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:33,956 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:33,960 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:33,970 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:33,970 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:03:33,975 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:03:33,975 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:03:33,981 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:33,981 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:03:33,992 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:33,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:03:33,992 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:34,007 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:34,011 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:03:34,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:03:34,017 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:34,017 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:34,017 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:34,017 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:34,018 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:34,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:03:34,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:34,018 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:03:34,018 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:34,020 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:03:34,020 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:03:34,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:34,021 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:03:34,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:34,021 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:34,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:34,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:03:34,022 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:03:34,022 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:03:34,023 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:03:34,023 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:03:34,023 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:03:34,023 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:03:34,023 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:03:34,023 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:03:34,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:03:34,024 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:03:34,024 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:03:34,025 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:34,025 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:03:34,025 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:34,025 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:34,026 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:34,026 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:03:34,026 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:03:34,026 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:03:34,026 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:03:34,030 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:03:34,030 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:34,031 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:34,032 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:03:34,033 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:34,033 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:34,033 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:34,034 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:34,049 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5365, Threshold=0.5598, Accuracy=0.7200, F1=0.8076, Precision=0.9797, Recall=0.6870
2025-08-04 21:03:34,050 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7200, F1: 0.8076, Prec: 0.9797, Rec: 0.6870, Avg Anomaly Score: 0.5365
2025-08-04 21:03:45,345 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:45,345 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:03:45,345 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:03:45,345 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:03:45,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:03:45,346 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:45,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:45,838 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:45,942 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:03:45,991 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:03:45,991 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:46,179 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:46,188 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:46,191 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:46,200 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:03:46,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:46,213 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:03:46,214 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:46,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:46,214 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:03:46,225 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:46,228 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,230 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:46,234 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:46,237 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:46,240 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:46,243 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,246 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:46,249 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:46,251 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:46,254 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:46,265 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:46,265 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:03:46,270 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:03:46,272 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:03:46,277 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:46,277 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:03:46,289 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:46,289 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:03:46,289 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:46,305 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:46,309 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:03:46,316 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:46,317 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:46,320 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:03:46,320 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:03:46,321 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:46,321 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:03:46,321 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:46,321 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:46,321 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:46,322 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:03:46,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:03:46,322 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:03:46,322 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:03:46,323 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:03:46,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:03:46,323 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:03:46,324 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:03:46,324 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:03:46,324 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:46,324 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:03:46,325 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:46,325 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:46,328 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:46,328 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:03:46,328 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:03:46,329 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:03:46,329 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:03:46,334 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:03:46,334 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:46,336 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:46,336 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:03:46,338 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:46,338 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:46,338 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:46,339 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:46,356 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.4913, Threshold=0.4757, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:03:46,356 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.4913
2025-08-04 21:04:00,648 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:00,648 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:04:00,652 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:04:00,652 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:04:00,653 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:04:00,653 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:01,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:01,078 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:01,179 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:04:01,227 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:04:01,228 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:01,382 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:01,393 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:01,393 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:01,403 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:04:01,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:01,434 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:04:01,435 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:01,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:01,435 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:04:01,449 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:01,452 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,455 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:01,457 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:01,461 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:01,465 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:01,468 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,472 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:01,479 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:01,482 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:01,487 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:01,498 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:01,499 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:04:01,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:04:01,505 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:04:01,511 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:01,511 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:04:01,526 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:01,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:04:01,527 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:01,550 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:01,558 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:04:01,566 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:04:01,567 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:01,567 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:01,567 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:01,567 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:01,568 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:01,568 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:04:01,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:01,569 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:04:01,569 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:01,571 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:04:01,571 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:04:01,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:01,572 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:04:01,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:01,572 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:01,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:01,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:04:01,573 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:04:01,573 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:04:01,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:04:01,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:04:01,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:04:01,574 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:04:01,574 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:04:01,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:04:01,575 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:04:01,575 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:04:01,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:04:01,576 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:01,576 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:04:01,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:01,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:01,577 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:01,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:04:01,578 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:04:01,578 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:04:01,578 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:04:01,587 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:04:01,588 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:01,589 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:01,590 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:04:01,592 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:01,592 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:01,593 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:01,594 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:01,615 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5581, Threshold=0.6015, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:04:01,616 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5581
2025-08-04 21:04:15,906 - ClientAppLogger [Client 0] - INFO - ClientApp starting for partition_id: 0. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:15,906 - ClientAppLogger [Client 0] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 21:04:15,907 - ClientAppLogger [Client 0] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 21:04:15,907 - ClientAppLogger [Client 0] - INFO - Loading data for partition 0/10...
2025-08-04 21:04:15,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting load_data function.
2025-08-04 21:04:15,907 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:22,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:22,630 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:22,766 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Numeric conversion completed.
2025-08-04 21:04:22,850 - ClientAppLogger [Client 0] - INFO - [LoadData 0] NA values filled.
2025-08-04 21:04:22,851 - ClientAppLogger [Client 0] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:25,256 - ClientAppLogger [Client 0] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,269 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,270 - ClientAppLogger [Client 0] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,283 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Scaler fitting process completed.
2025-08-04 21:04:25,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,299 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,300 - ClientAppLogger [Client 0] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,300 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting anomaly reduction logic.
2025-08-04 21:04:25,312 - ClientAppLogger [Client 0] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,317 - ClientAppLogger [Client 0] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,322 - ClientAppLogger [Client 0] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,324 - ClientAppLogger [Client 0] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,329 - ClientAppLogger [Client 0] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,333 - ClientAppLogger [Client 0] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,337 - ClientAppLogger [Client 0] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,342 - ClientAppLogger [Client 0] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,346 - ClientAppLogger [Client 0] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,349 - ClientAppLogger [Client 0] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,353 - ClientAppLogger [Client 0] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,369 - ClientAppLogger [Client 0] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,370 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Anomaly reduction logic completed.
2025-08-04 21:04:25,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,376 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating unlabeled training base.
2025-08-04 21:04:25,386 - ClientAppLogger [Client 0] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,388 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating labeled pool.
2025-08-04 21:04:25,410 - ClientAppLogger [Client 0] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,411 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Labeled pool creation completed.
2025-08-04 21:04:25,412 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,437 - ClientAppLogger [Client 0] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,447 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Combining data for final AE training set.
2025-08-04 21:04:25,477 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Final AE training data combination completed.
2025-08-04 21:04:25,478 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,478 - ClientAppLogger [Client 0] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,478 - ClientAppLogger [Client 0] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,480 - ClientAppLogger [Client 0] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,481 - ClientAppLogger [Client 0] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,481 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] START of partitioning block.
2025-08-04 21:04:25,482 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,482 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 1: Full indices created.
2025-08-04 21:04:25,482 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,486 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 2: Full indices shuffled.
2025-08-04 21:04:25,486 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,486 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,487 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,488 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,488 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,488 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,489 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 6: Start indices calculated. train_start=0
2025-08-04 21:04:25,489 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Start indices calculated. Train_start=0, Val_start=0, Test_start=0
2025-08-04 21:04:25,489 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 7: End indices calculated. train_end=117
2025-08-04 21:04:25,490 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: End indices calculated. Train_end=117, Val_end=575, Test_end=161
2025-08-04 21:04:25,491 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 8: Partition-specific indices extracted. Num train indices: 117
2025-08-04 21:04:25,491 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Specific indices extracted. Train idx: 117, Val idx: 575, Test idx: 161
2025-08-04 21:04:25,491 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9a: Train data sliced for partition. X_train_part_full shape: (117, 17)
2025-08-04 21:04:25,491 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Train data sliced. Shape: (117, 17)
2025-08-04 21:04:25,492 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9b: Validation data sliced for partition. X_val_part shape: (575, 17)
2025-08-04 21:04:25,492 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Validation data sliced. Shape: (575, 17)
2025-08-04 21:04:25,492 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 9c: Test data sliced for partition. X_test_part shape: (161, 17)
2025-08-04 21:04:25,492 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Partitioning: Test data sliced. Shape: (161, 17)
2025-08-04 21:04:25,493 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,493 - ClientAppLogger [Client 0] - INFO - [LoadData 0] Creating TonIoTDataset objects.
2025-08-04 21:04:25,494 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,494 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,495 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,495 - ClientAppLogger [Client 0] - INFO - [LoadData 0] TonIoTDataset objects created.
2025-08-04 21:04:25,496 - ClientAppLogger [Client 0] - INFO - Partition 0 (Static Datasets): Train Potential 117, Val 575, Test 161
2025-08-04 21:04:25,496 - ClientAppLogger [Client 0] - INFO - [Partitioning Debug 0] END of partitioning block, returning datasets.
2025-08-04 21:04:25,496 - ClientAppLogger [Client 0] - INFO - [LoadData 0] load_data function completed.
2025-08-04 21:04:25,509 - ClientAppLogger [Client 0] - INFO - Data loaded for partition 0: Train samples: 117, Val samples: 575
2025-08-04 21:04:25,510 - ClientAppLogger [Client 0] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,512 - ClientAppLogger [Client 0] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,512 - ClientAppLogger [Client 0] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 21:04:25,515 - ClientAppLogger [Client 0] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,515 - ClientAppLogger [Client 0] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,515 - ClientAppLogger [Client 0] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,517 - ClientAppLogger [Client 0] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,536 - ClientAppLogger [Client 0] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=575, Avg Anomaly Score (all samples)=0.5577, Threshold=0.6145, Accuracy=0.7270, F1=0.8124, Precision=0.9855, Recall=0.6911
2025-08-04 21:04:25,536 - ClientAppLogger [Client 0] - INFO - [Client] Evaluation finished. Samples: 575, Acc: 0.7270, F1: 0.8124, Prec: 0.9855, Rec: 0.6911, Avg Anomaly Score: 0.5577
