2025-08-04 21:00:15,653 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:15,653 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:15,653 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:15,653 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:00:15,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:00:15,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:16,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:16,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:16,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:00:16,250 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:00:16,250 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:16,457 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:16,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:16,465 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:16,473 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:00:16,483 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:16,483 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:00:16,484 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:16,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:16,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:00:16,495 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:16,499 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,501 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:16,504 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:16,506 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:16,509 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:16,512 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,514 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:16,518 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:16,520 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:16,523 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:16,535 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:16,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:00:16,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:00:16,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:00:16,547 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:16,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:00:16,560 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:16,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:00:16,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:16,580 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:16,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:00:16,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:00:16,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:16,601 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:16,601 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:16,601 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:16,601 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:16,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:00:16,602 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:16,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:00:16,602 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:16,604 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:00:16,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:00:16,605 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:16,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:00:16,606 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:16,606 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:16,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:16,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:00:16,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:00:16,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:00:16,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:00:16,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:00:16,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:00:16,610 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:00:16,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:00:16,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:00:16,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:00:16,612 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:00:16,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:00:16,614 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:16,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:00:16,614 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:16,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:16,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:16,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:00:16,615 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:00:16,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:00:16,616 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:00:16,627 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:00:16,627 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:16,629 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:16,631 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:16,633 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:16,633 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:16,633 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:16,634 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:16,646 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5305, Threshold=0.5924, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:00:16,647 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5305
2025-08-04 21:00:39,950 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:39,950 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:39,950 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:39,950 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:00:39,951 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:00:39,951 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:40,363 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:40,363 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:40,467 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:00:40,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:00:40,496 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:40,649 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:40,657 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:40,657 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:40,664 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:00:40,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:40,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:00:40,671 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:40,671 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:40,671 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:00:40,679 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:40,682 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,684 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:40,686 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:40,689 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:40,691 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:40,694 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,696 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:40,699 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:40,701 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:40,703 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:40,713 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:40,714 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:00:40,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:00:40,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:00:40,724 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:40,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:00:40,735 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:40,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:00:40,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:40,752 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:40,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:00:40,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:00:40,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:40,773 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:40,773 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:40,773 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:40,773 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:40,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:00:40,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:40,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:00:40,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:40,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:00:40,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:00:40,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:40,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:00:40,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:40,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:40,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:40,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:00:40,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:00:40,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:00:40,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:00:40,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:00:40,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:00:40,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:00:40,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:00:40,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:00:40,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:00:40,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:00:40,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:00:40,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:40,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:00:40,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:40,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:40,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:40,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:00:40,781 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:00:40,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:00:40,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:00:40,789 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:00:40,790 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:40,791 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:40,791 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:40,792 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:40,793 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:40,793 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:40,793 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:40,802 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5151, Threshold=0.5688, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:00:40,802 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5151
2025-08-04 21:01:01,106 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:01,107 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:01,107 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:01,107 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:01:01,107 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:01:01,107 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:01,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:01,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:01,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:01:01,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:01:01,698 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:01,855 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:01,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:01,861 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:01,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:01:01,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:01,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:01:01,873 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:01,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:01,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:01:01,883 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:01,886 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,888 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:01,891 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:01,894 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:01,897 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:01,900 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,902 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:01,905 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:01,907 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:01,909 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:01,920 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:01,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:01:01,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:01:01,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:01:01,931 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:01,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:01:01,943 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:01,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:01:01,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:01,960 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:01,966 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:01:01,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:01:01,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:01,974 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:01,974 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:01,974 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:01,975 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:01,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:01:01,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:01,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:01:01,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:01,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:01:01,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:01:01,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:01,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:01:01,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:01,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:01,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:01,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:01:01,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:01:01,979 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:01:01,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:01:01,979 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:01:01,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:01:01,980 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:01:01,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:01:01,981 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:01:01,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:01:01,981 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:01:01,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:01:01,982 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:01,982 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:01:01,982 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:01,982 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:01,983 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:01,983 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:01:01,983 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:01:01,984 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:01:01,984 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:01:01,990 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:01:01,991 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:01,992 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:01,992 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:01,994 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:01,994 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:01,994 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:01,995 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:02,003 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5339, Threshold=0.5916, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:01:02,003 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5339
2025-08-04 21:01:25,295 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:25,295 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:25,295 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:25,295 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:01:25,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:01:25,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:25,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:25,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:25,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:01:25,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:01:25,828 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:25,958 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:25,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:25,964 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:25,969 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:01:25,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:25,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:01:25,978 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:25,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:25,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:01:25,988 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:25,991 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,994 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:25,996 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:25,999 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:26,001 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:26,005 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:26,008 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:26,011 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:26,013 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:26,015 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:26,026 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:26,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:01:26,033 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:01:26,033 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:01:26,040 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:26,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:01:26,054 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:26,055 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:01:26,055 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:26,070 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:26,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:01:26,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:01:26,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:26,084 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:26,084 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:26,084 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:26,085 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:26,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:01:26,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:26,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:01:26,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:26,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:01:26,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:01:26,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:26,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:01:26,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:26,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:26,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:01:26,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:01:26,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:01:26,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:01:26,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:01:26,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:01:26,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:01:26,091 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:26,091 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:01:26,091 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:26,091 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:26,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:26,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:01:26,092 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:01:26,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:01:26,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:01:26,102 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:01:26,102 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:26,103 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:26,104 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:26,105 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:26,105 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:26,105 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:26,106 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:26,115 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5055, Threshold=0.5596, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:01:26,115 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5055
2025-08-04 21:01:37,399 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:37,399 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:37,399 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:37,399 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:01:37,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:01:37,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:37,867 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:37,868 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:37,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:01:38,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:01:38,022 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:38,171 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:38,178 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:38,179 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:38,185 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:01:38,197 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:38,198 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:01:38,198 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:38,199 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:38,199 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:01:38,208 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:38,211 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,213 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:38,215 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:38,218 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:38,220 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:38,223 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,226 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:38,229 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:38,231 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:38,233 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:38,243 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:38,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:01:38,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:01:38,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:01:38,254 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:38,254 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:01:38,266 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:38,266 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:01:38,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:38,283 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:38,287 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:01:38,293 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:01:38,293 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:38,293 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:38,293 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:38,293 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:38,294 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:38,294 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:01:38,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:38,294 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:01:38,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:38,296 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:01:38,296 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:01:38,296 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:01:38,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:01:38,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:01:38,298 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:01:38,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:01:38,298 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:01:38,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:01:38,299 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:01:38,299 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:01:38,299 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:01:38,299 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:01:38,299 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:38,300 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:01:38,300 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:38,300 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:38,300 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:38,301 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:01:38,301 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:01:38,301 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:01:38,301 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:01:38,310 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:01:38,310 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:38,312 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:38,312 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:38,314 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:38,314 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:38,314 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:38,315 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:38,324 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5548, Threshold=0.6371, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:01:38,324 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5548
2025-08-04 21:01:49,613 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:49,613 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:49,613 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:49,614 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:01:49,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:01:49,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:50,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:50,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:50,111 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:01:50,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:01:50,145 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:50,276 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:50,284 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:50,284 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:50,289 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:01:50,297 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:50,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:01:50,299 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:50,299 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:50,300 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:01:50,310 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:50,313 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:50,316 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:50,318 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:50,321 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:50,323 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:50,325 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:50,328 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:50,330 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:50,332 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:50,335 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:50,344 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:50,344 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:01:50,349 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:01:50,349 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:01:50,355 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:50,356 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:01:50,367 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:50,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:01:50,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:50,382 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:50,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:01:50,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:01:50,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:50,399 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:50,399 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:50,399 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:50,400 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:50,400 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:01:50,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:50,400 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:01:50,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:50,401 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:01:50,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:01:50,402 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:50,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:01:50,402 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:50,403 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:50,403 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:50,403 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:01:50,403 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:01:50,403 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:01:50,403 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:01:50,404 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:01:50,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:01:50,404 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:01:50,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:01:50,404 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:01:50,405 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:01:50,405 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:01:50,405 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:01:50,405 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:50,405 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:01:50,406 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:50,406 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:50,406 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:50,406 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:01:50,406 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:01:50,407 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:01:50,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:01:50,415 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:01:50,415 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:50,416 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:50,417 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:50,418 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:50,419 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:50,419 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:50,420 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:50,428 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4911, Threshold=0.5282, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:01:50,428 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4911
2025-08-04 21:02:10,737 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:10,737 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:10,738 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:10,738 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:02:10,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:02:10,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:11,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:11,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:11,245 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:02:11,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:02:11,295 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:11,434 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:11,441 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:11,441 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:11,447 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:02:11,454 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:11,454 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:02:11,455 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:11,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:11,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:02:11,466 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:11,470 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,472 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:11,475 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:11,478 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:11,484 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:11,487 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,494 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:11,499 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:11,501 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:11,504 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:11,513 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:11,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:02:11,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:02:11,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:02:11,523 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:11,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:02:11,532 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:11,532 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:02:11,533 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:11,550 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:11,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:02:11,559 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:02:11,559 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:11,559 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:11,560 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:11,560 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:11,560 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:11,560 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:02:11,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:11,561 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:02:11,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:11,562 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:02:11,562 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:02:11,562 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:11,563 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:02:11,563 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:11,563 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:11,563 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:11,563 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:02:11,563 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:02:11,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:02:11,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:02:11,565 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:02:11,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:02:11,565 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:11,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:02:11,566 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:11,566 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:11,566 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:11,566 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:02:11,566 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:02:11,567 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:02:11,567 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:02:11,570 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:02:11,570 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:11,571 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:11,571 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:11,573 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:11,573 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:11,573 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:11,574 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:11,582 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5315, Threshold=0.5928, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:02:11,582 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5315
2025-08-04 21:02:31,929 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:31,930 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:31,930 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:31,930 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:02:31,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:02:31,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:32,356 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:32,356 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:32,451 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:02:32,478 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:02:32,478 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:32,607 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:32,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:32,615 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:32,623 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:02:32,677 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:32,677 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:02:32,678 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:32,678 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:32,678 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:02:32,687 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:32,690 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,693 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:32,695 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:32,697 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:32,700 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:32,702 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,705 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:32,708 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:32,710 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:32,713 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:32,723 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:32,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:02:32,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:02:32,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:02:32,735 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:32,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:02:32,757 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:32,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:02:32,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:32,772 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:32,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:02:32,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:02:32,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:32,782 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:32,782 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:32,782 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:32,782 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:32,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:02:32,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:32,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:02:32,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:32,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:02:32,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:02:32,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:32,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:02:32,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:32,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:32,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:32,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:02:32,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:02:32,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:02:32,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:02:32,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:02:32,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:02:32,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:02:32,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:02:32,788 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:02:32,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:02:32,788 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:02:32,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:02:32,788 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:32,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:02:32,789 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:32,789 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:32,789 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:32,790 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:02:32,790 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:02:32,790 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:02:32,790 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:02:32,799 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:02:32,799 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:32,800 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:32,801 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:32,802 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:32,802 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:32,802 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:32,803 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:32,812 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5439, Threshold=0.6076, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:02:32,812 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5439
2025-08-04 21:02:53,173 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:53,173 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:53,173 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:53,174 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:02:53,174 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:02:53,174 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:53,644 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:53,644 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:53,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:02:53,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:02:53,758 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:53,905 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:53,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:53,912 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:53,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:02:53,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:53,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:02:53,926 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:53,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:53,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:02:53,935 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:53,939 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,941 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:53,944 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:53,947 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:53,949 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:53,952 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,954 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:53,958 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:53,961 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:53,964 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:53,976 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:53,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:02:53,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:02:53,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:02:53,986 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:02:53,997 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,998 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:02:53,998 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:54,014 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:54,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:02:54,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:02:54,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:54,025 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:54,025 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:54,026 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:54,026 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:54,026 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:02:54,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:54,027 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:02:54,027 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:54,028 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:02:54,029 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:02:54,029 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:54,029 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:02:54,029 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:54,029 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:54,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:54,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:02:54,030 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:02:54,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:02:54,030 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:02:54,031 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:02:54,032 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:02:54,032 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:02:54,032 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:02:54,033 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:02:54,033 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:02:54,033 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:02:54,034 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:02:54,034 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:54,034 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:02:54,034 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:54,034 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:54,035 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:54,035 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:02:54,035 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:02:54,035 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:02:54,035 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:02:54,041 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:02:54,041 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:54,043 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:54,043 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:54,044 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:54,045 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:54,045 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:54,046 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:54,054 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4947, Threshold=0.5394, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:02:54,054 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4947
2025-08-04 21:03:14,386 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:14,386 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:14,387 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:14,387 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:03:14,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:03:14,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:15,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:15,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:15,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:03:15,235 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:03:15,235 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:15,438 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:15,448 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:15,448 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:15,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:03:15,466 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:15,466 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:03:15,467 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:15,467 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:15,467 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:03:15,480 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:15,484 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,487 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:15,490 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:15,494 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:15,497 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:15,505 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,508 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:15,513 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:15,517 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:15,520 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:15,535 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:15,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:03:15,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:03:15,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:03:15,549 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:15,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:03:15,564 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:15,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:03:15,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:15,582 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:15,587 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:03:15,595 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:03:15,596 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:15,596 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:15,596 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:15,597 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:15,597 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:15,597 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:03:15,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:15,598 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:03:15,598 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:15,599 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:03:15,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:03:15,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:15,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:03:15,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:15,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:15,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:15,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:03:15,601 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:03:15,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:03:15,603 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:03:15,603 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:03:15,603 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:03:15,604 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:03:15,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:03:15,604 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:03:15,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:03:15,605 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:03:15,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:03:15,605 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:15,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:03:15,606 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:15,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:15,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:15,607 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:03:15,607 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:03:15,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:03:15,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:03:15,615 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:03:15,615 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:15,617 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:15,617 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:15,619 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:15,619 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:15,619 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:15,620 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:15,632 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5472, Threshold=0.6037, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:03:15,632 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5472
2025-08-04 21:03:32,985 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:32,986 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:32,990 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:32,991 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:03:32,991 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:03:32,992 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:33,487 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:33,487 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,595 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:03:33,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:03:33,629 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:33,793 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:33,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:33,803 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:33,809 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:03:33,820 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:33,820 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:03:33,821 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:33,821 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:33,821 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:03:33,834 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:33,838 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,840 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:33,843 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:33,846 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:33,848 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:33,851 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,853 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:33,857 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:33,859 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:33,861 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:33,872 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:33,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:03:33,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:03:33,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:03:33,886 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:33,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:03:33,900 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:33,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:03:33,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:33,923 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:33,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:03:33,936 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:03:33,936 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:33,936 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:33,936 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:33,937 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:33,937 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:33,937 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:03:33,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:33,938 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:03:33,938 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:33,939 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:03:33,940 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:03:33,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:33,940 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:03:33,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:03:33,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:03:33,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:03:33,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:03:33,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:03:33,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:03:33,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:03:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:03:33,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:03:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:33,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:03:33,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:33,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:33,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:33,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:03:33,945 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:03:33,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:03:33,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:03:33,953 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:03:33,953 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:33,955 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:33,955 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:33,957 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:33,957 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:33,957 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:33,958 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:33,967 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5323, Threshold=0.5840, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:03:33,967 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5323
2025-08-04 21:03:45,255 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:45,255 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:45,255 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:45,255 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:03:45,256 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:03:45,256 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:45,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:45,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:45,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:03:45,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:03:45,913 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:46,085 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:46,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:46,092 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:46,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:03:46,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:46,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:03:46,109 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:46,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:46,110 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:03:46,119 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:46,122 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,125 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:46,127 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:46,130 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:46,132 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:46,135 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,137 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:46,140 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:46,142 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:46,145 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:46,156 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:46,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:03:46,163 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:03:46,163 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:03:46,172 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:46,172 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:03:46,191 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:46,192 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:03:46,192 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:46,214 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:46,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:03:46,228 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:03:46,228 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:46,228 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:46,232 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:46,232 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:46,232 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:46,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:03:46,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:46,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:03:46,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:46,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:03:46,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:03:46,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:46,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:03:46,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:46,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:03:46,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:03:46,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:03:46,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:03:46,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:03:46,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:03:46,240 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:03:46,240 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:03:46,240 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:46,240 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:03:46,240 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:46,241 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:46,241 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:46,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:03:46,243 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:03:46,243 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:03:46,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:03:46,250 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:03:46,250 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:46,251 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:46,252 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:46,253 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:46,254 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:46,257 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:46,262 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:46,271 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4871, Threshold=0.5095, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:03:46,272 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4871
2025-08-04 21:04:00,585 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:00,593 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:04:00,593 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:04:00,594 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:04:00,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:04:00,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:01,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:01,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:01,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:04:01,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:04:01,244 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:01,425 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:01,434 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:01,434 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:01,444 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:04:01,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:01,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:04:01,453 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:01,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:01,454 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:04:01,464 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:01,467 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,472 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:01,479 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:01,483 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:01,487 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:01,490 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,493 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:01,497 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:01,501 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:01,504 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:01,515 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:01,515 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:04:01,520 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:04:01,520 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:04:01,527 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:01,527 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:04:01,541 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:01,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:04:01,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:01,565 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:01,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:04:01,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:04:01,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:01,581 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:01,581 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:01,581 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:01,582 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:01,582 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:04:01,582 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:01,583 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:04:01,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:01,584 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:04:01,584 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:04:01,585 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:01,585 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:04:01,585 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:01,585 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:01,586 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:01,586 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:04:01,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:04:01,586 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:04:01,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:04:01,587 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:04:01,587 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:04:01,587 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:04:01,588 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:04:01,588 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:04:01,588 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:04:01,588 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:04:01,589 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:04:01,589 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:01,589 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:04:01,590 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:01,590 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:01,590 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:01,590 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:04:01,591 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:04:01,591 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:04:01,591 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:04:01,598 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:04:01,598 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:01,600 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:01,600 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:01,603 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:01,615 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5555, Threshold=0.6287, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:04:01,615 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5555
2025-08-04 21:04:15,902 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:15,902 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:04:15,902 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:04:15,902 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 21:04:15,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 21:04:15,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:22,441 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:22,441 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:22,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 21:04:22,668 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 21:04:22,668 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:25,224 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,238 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,257 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 21:04:25,278 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,278 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,279 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,279 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 21:04:25,293 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,297 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,301 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,304 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,308 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,311 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,317 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,321 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,325 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,329 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,333 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,351 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 21:04:25,358 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,359 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 21:04:25,370 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,370 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 21:04:25,416 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,417 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 21:04:25,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,446 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 21:04:25,480 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 21:04:25,481 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,481 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,482 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,482 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,485 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 21:04:25,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 21:04:25,486 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,487 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 21:04:25,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,489 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,489 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,490 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,490 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,490 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,490 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 21:04:25,491 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 21:04:25,491 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 21:04:25,492 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 21:04:25,492 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 21:04:25,492 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 21:04:25,492 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 21:04:25,493 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 21:04:25,493 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 21:04:25,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 21:04:25,495 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 21:04:25,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 21:04:25,496 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 21:04:25,497 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 21:04:25,500 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 21:04:25,501 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 21:04:25,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 21:04:25,515 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 21:04:25,516 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,517 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,518 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:04:25,520 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,520 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,520 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,521 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,532 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5551, Threshold=0.6378, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 21:04:25,532 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5551
