2025-08-04 21:00:16,089 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:16,089 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:00:16,089 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:00:16,090 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:00:16,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:00:16,090 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:16,561 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:16,562 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:16,672 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:00:16,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:00:16,703 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:16,802 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:16,809 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:16,809 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:16,829 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:00:16,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:16,854 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:00:16,855 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:16,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:16,855 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:00:16,864 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:16,867 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,869 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:16,872 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:16,874 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:16,877 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:16,879 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,882 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:16,885 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:16,887 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:16,889 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:16,899 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:16,899 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:00:16,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:00:16,905 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:00:16,912 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:16,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:00:16,929 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:16,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:00:16,929 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:16,948 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:16,953 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:00:16,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:00:16,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:16,958 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:16,958 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:16,959 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:16,959 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:16,959 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:00:16,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:16,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:00:16,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:16,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:00:16,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:00:16,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:00:16,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:00:16,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:00:16,963 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:00:16,963 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:00:16,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:00:16,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:00:16,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:00:16,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:00:16,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:00:16,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:00:16,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:16,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:00:16,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:16,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:16,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:16,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:00:16,966 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:00:16,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:00:16,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:00:16,973 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:00:16,973 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:16,974 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:16,974 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:00:16,975 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:16,976 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:16,976 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:16,976 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:16,986 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5213, Threshold=0.5927, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:00:16,986 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5213
2025-08-04 21:00:40,314 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:40,314 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:00:40,315 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:00:40,315 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:00:40,315 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:00:40,315 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:40,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:40,656 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:40,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:00:40,777 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:00:40,778 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:40,897 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:40,903 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:40,903 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:40,910 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:00:40,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:40,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:00:40,917 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:40,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:40,917 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:00:40,926 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:40,928 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,931 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:40,933 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:40,935 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:40,938 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:40,940 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:40,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:40,947 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:40,950 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:40,959 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:40,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:00:40,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:00:40,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:00:40,969 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:40,969 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:00:40,980 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:40,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:00:40,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:40,997 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:41,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:00:41,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:00:41,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:41,011 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:41,011 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:41,011 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:41,012 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:41,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:00:41,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:41,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:00:41,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:41,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:00:41,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:00:41,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:41,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:00:41,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:41,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:41,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:41,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:00:41,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:00:41,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:00:41,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:00:41,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:00:41,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:00:41,016 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:00:41,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:00:41,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:00:41,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:00:41,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:00:41,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:00:41,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:41,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:00:41,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:41,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:41,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:41,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:00:41,019 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:00:41,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:00:41,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:00:41,026 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:00:41,026 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:41,027 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:41,027 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:00:41,029 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:41,029 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:41,029 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:41,030 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:41,038 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5071, Threshold=0.5684, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:00:41,038 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5071
2025-08-04 21:00:49,310 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:49,310 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:00:49,311 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:00:49,311 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:00:49,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:00:49,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:49,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:49,648 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:49,734 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:00:49,762 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:00:49,763 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:49,867 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:49,872 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:49,872 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:49,893 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:00:49,912 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:49,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:00:49,913 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:49,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:49,913 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:00:49,922 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:49,925 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:49,927 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:49,930 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:49,932 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:49,935 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:49,937 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:49,940 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:49,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:49,945 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:49,947 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:49,957 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:49,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:00:49,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:00:49,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:00:49,966 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:49,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:00:49,976 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:49,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:00:49,976 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:49,991 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:49,996 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:00:50,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:00:50,001 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:50,002 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:50,002 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:50,002 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:50,002 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:50,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:00:50,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:50,003 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:00:50,003 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:50,004 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:00:50,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:00:50,005 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:50,005 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:00:50,005 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:00:50,006 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:00:50,007 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:00:50,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:00:50,007 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:00:50,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:00:50,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:00:50,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:00:50,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:50,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:00:50,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:50,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:50,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:50,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:00:50,009 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:00:50,009 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:00:50,009 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:00:50,016 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:00:50,017 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:50,018 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:50,018 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:00:50,020 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 160/400.
2025-08-04 21:00:50,121 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:50,121 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:50,123 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 816 anomalous samples to GAN training data (target: 816).
2025-08-04 21:00:50,123 - ClientAppLogger [Client 2] - INFO - [Client] Round 160: Training GAN with 3537 samples (2721 normal, 816 anomalous).
2025-08-04 21:00:50,124 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:52,949 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0829, Avg D Loss: 0.7735
2025-08-04 21:00:52,949 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0829, Avg D Loss: 0.7735
2025-08-04 21:00:52,949 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:52,958 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4964, Threshold=0.5522, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:00:52,958 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 21:00:52,958 - ClientAppLogger [Client 2] - INFO - Fit completed for round 160. Duration: 2.94s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 160, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.082904839232577, 'd_loss': 0.7735175570475707, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.9381165504455566, 'cpu_percent_fit': 31.16875, 'ram_mb_fit': 8.82421875, 'accumulated_train_samples_this_round': 3537}
2025-08-04 21:00:52,958 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 21:01:01,240 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:01,240 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:01,240 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:01,240 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:01:01,240 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:01:01,241 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:01,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:01,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:01,678 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:01:01,700 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:01:01,700 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:01,829 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:01,837 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:01,837 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:01,843 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:01:01,848 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:01,849 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:01:01,849 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:01,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:01,850 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:01:01,858 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:01,861 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,864 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:01,866 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:01,869 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:01,871 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:01,874 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,877 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:01,880 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:01,882 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:01,884 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:01,896 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:01,896 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:01:01,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:01:01,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:01:01,908 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:01,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:01:01,920 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:01,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:01:01,920 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:01,938 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:01,944 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:01:01,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:01:01,957 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:01,957 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:01,957 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:01,957 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:01,958 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:01,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:01:01,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:01,958 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:01:01,959 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:01,960 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:01:01,960 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:01:01,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:01,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:01:01,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:01,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:01,961 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:01,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:01:01,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:01:01,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:01:01,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:01:01,962 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:01:01,962 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:01:01,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:01:01,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:01:01,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:01:01,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:01:01,964 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:01:01,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:01:01,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:01,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:01:01,965 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:01,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:01,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:01,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:01:01,966 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:01:01,966 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:01:01,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:01:01,974 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:01:01,975 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:01,976 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:01,976 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:01,978 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:01,978 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:01,978 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:01,979 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:01,988 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5248, Threshold=0.5902, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:01:01,988 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5248
2025-08-04 21:01:25,286 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:25,286 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:25,287 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:25,287 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:01:25,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:01:25,287 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:25,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:25,650 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:25,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:01:25,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:01:25,775 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:25,895 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:25,902 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:25,902 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:25,908 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:01:25,915 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:25,915 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:01:25,915 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:25,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:25,916 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:01:25,925 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:25,928 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,930 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:25,933 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:25,936 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:25,938 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:25,940 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:25,946 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:25,948 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:25,950 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:25,960 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:25,961 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:01:25,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:01:25,966 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:01:25,973 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:25,973 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:01:25,987 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:25,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:01:25,988 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:26,004 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:26,010 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:01:26,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:01:26,023 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:26,023 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:26,024 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:26,024 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:26,024 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:26,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:01:26,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:26,025 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:01:26,025 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:26,027 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:01:26,027 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:01:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:26,028 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:01:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:26,028 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:26,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:01:26,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:01:26,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:01:26,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:01:26,029 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:01:26,029 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:01:26,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:01:26,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:01:26,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:01:26,031 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:01:26,031 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:01:26,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:01:26,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:26,032 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:01:26,032 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:26,033 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:26,033 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:26,033 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:01:26,033 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:01:26,034 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:01:26,034 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:01:26,041 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:01:26,041 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:26,042 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:26,043 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:26,044 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:26,044 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:26,044 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:26,045 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:26,053 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4975, Threshold=0.5575, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:01:26,054 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4975
2025-08-04 21:01:37,364 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:37,365 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:37,365 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:37,365 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:01:37,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:01:37,365 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:37,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:37,742 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:37,835 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:01:37,870 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:01:37,870 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:37,983 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:37,993 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:37,994 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:38,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:01:38,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:38,069 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:01:38,073 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:38,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:38,073 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:01:38,083 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:38,086 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,088 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:38,090 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:38,093 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:38,095 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:38,098 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:38,100 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:38,103 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:38,105 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:38,107 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:38,117 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:38,117 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:01:38,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:01:38,123 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:01:38,129 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:38,130 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:01:38,142 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:38,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:01:38,143 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:38,159 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:38,164 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:01:38,170 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:01:38,171 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:38,171 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:38,171 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:38,171 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:38,172 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:38,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:01:38,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:38,172 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:01:38,172 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:38,174 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:01:38,174 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:01:38,175 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:01:38,176 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:01:38,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:01:38,176 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:01:38,176 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:01:38,178 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:01:38,178 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:01:38,179 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:01:38,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:01:38,179 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:01:38,179 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:01:38,179 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:38,180 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:01:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:38,180 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:38,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:01:38,181 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:01:38,181 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:01:38,181 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:01:38,194 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:01:38,194 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:38,195 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:38,196 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:38,197 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:38,197 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:38,198 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:38,199 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:38,208 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5449, Threshold=0.6394, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:01:38,208 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5449
2025-08-04 21:01:49,494 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:49,494 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:01:49,495 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:01:49,495 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:01:49,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:01:49,495 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:49,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:49,853 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:49,942 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:01:49,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:01:49,971 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:50,095 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:50,101 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:50,101 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:50,124 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:01:50,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:50,151 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:01:50,152 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:50,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:50,152 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:01:50,164 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:50,167 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:50,169 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:50,171 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:50,175 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:50,177 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:50,180 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:50,182 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:50,186 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:50,188 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:50,191 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:50,202 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:50,202 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:01:50,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:01:50,207 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:01:50,213 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:50,213 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:01:50,226 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:50,227 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:01:50,227 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:50,244 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:50,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:01:50,256 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:01:50,256 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:50,256 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:50,257 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:50,257 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:50,257 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:50,258 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:01:50,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:50,258 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:01:50,258 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:50,260 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:01:50,260 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:01:50,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:50,261 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:01:50,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:50,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:50,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:50,261 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:01:50,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:01:50,262 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:01:50,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:01:50,262 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:01:50,262 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:01:50,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:01:50,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:01:50,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:01:50,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:01:50,264 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:01:50,264 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:01:50,265 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:50,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:01:50,265 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:50,265 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:50,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:50,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:01:50,266 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:01:50,266 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:01:50,266 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:01:50,278 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:01:50,278 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:50,280 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:50,280 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:01:50,282 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:50,282 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:50,282 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:50,283 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:50,293 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4838, Threshold=0.5284, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:01:50,294 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4838
2025-08-04 21:02:10,623 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:10,623 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:10,623 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:10,623 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:02:10,623 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:02:10,624 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:10,982 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:10,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:11,083 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:02:11,113 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:02:11,113 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:11,226 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:11,232 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:11,233 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:11,239 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:02:11,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:11,248 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:02:11,249 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:11,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:11,249 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:02:11,259 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:11,263 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,265 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:11,268 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:11,271 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:11,273 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:11,276 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,278 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:11,281 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:11,283 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:11,286 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:11,297 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:11,298 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:02:11,302 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:02:11,303 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:02:11,310 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:11,310 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:02:11,334 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:11,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:02:11,335 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:11,353 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:11,359 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:02:11,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:02:11,366 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:11,366 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:11,366 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:11,367 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:11,367 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:11,367 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:02:11,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:11,368 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:02:11,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:11,369 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:02:11,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:02:11,370 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:11,370 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:02:11,370 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:11,370 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:02:11,371 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:02:11,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:02:11,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:02:11,373 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:02:11,373 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:02:11,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:02:11,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:02:11,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:11,374 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:02:11,374 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:11,378 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:11,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:11,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:02:11,379 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:02:11,379 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:02:11,379 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:02:11,384 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:02:11,384 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:11,385 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:11,385 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:11,387 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:11,387 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:11,387 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:11,388 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:11,397 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5229, Threshold=0.5930, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:02:11,397 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5229
2025-08-04 21:02:31,750 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:31,751 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:31,751 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:31,751 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:02:31,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:02:31,752 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:32,132 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:32,132 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:32,233 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:02:32,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:02:32,264 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:32,391 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:32,398 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:32,398 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:32,406 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:02:32,423 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:32,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:02:32,424 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:32,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:32,424 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:02:32,433 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:32,436 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,439 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:32,441 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:32,444 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:32,446 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:32,449 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,452 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:32,455 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:32,457 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:32,459 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:32,469 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:32,469 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:02:32,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:02:32,474 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:02:32,480 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:32,480 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:02:32,490 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:32,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:02:32,490 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:32,505 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:32,510 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:02:32,516 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:02:32,517 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:32,517 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:32,517 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:32,517 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:32,518 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:32,518 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:02:32,518 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:32,518 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:02:32,518 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:32,520 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:02:32,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:02:32,520 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:32,520 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:02:32,521 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:02:32,522 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:02:32,522 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:02:32,523 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:02:32,523 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:02:32,523 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:02:32,523 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:02:32,524 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:02:32,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:02:32,524 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:32,524 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:02:32,525 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:32,528 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:32,528 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:32,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:02:32,529 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:02:32,529 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:02:32,529 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:02:32,537 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:02:32,537 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:32,538 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:32,539 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:32,540 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:32,540 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:32,540 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:32,541 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:32,550 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5344, Threshold=0.6057, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:02:32,550 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5344
2025-08-04 21:02:37,827 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:37,827 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:37,827 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:37,827 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:02:37,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:02:37,827 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:38,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:38,225 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:38,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:02:38,338 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:02:38,338 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:38,436 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:38,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:38,442 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:38,459 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:02:38,478 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:38,478 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:02:38,479 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:38,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:38,479 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:02:38,487 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:38,490 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:38,492 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:38,495 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:38,498 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:38,500 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:38,502 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:38,505 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:38,508 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:38,510 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:38,512 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:38,522 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:38,522 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:02:38,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:02:38,527 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:02:38,531 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:38,531 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:02:38,541 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:38,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:02:38,541 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:38,556 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:38,560 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:02:38,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:02:38,566 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:38,566 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:38,566 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:38,567 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:38,567 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:38,567 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:02:38,567 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:38,568 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:02:38,568 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:38,569 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:02:38,569 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:02:38,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:38,570 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:02:38,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:38,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:38,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:38,570 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:02:38,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:02:38,571 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:02:38,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:02:38,571 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:02:38,571 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:02:38,572 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:02:38,572 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:02:38,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:02:38,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:02:38,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:02:38,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:02:38,573 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:38,573 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:02:38,574 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:38,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:38,577 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:38,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:02:38,578 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:02:38,578 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:02:38,578 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:02:38,586 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:02:38,586 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:38,587 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:38,587 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:38,589 - ClientAppLogger [Client 2] - INFO - [Client] Fit started for round 166/400.
2025-08-04 21:02:38,690 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:38,691 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:38,692 - ClientAppLogger [Client 2] - INFO - [Client] Semi-supervised: Added 847 anomalous samples to GAN training data (target: 847).
2025-08-04 21:02:38,696 - ClientAppLogger [Client 2] - INFO - [Client] Round 166: Training GAN with 3672 samples (2825 normal, 847 anomalous).
2025-08-04 21:02:38,696 - ClientAppLogger [Client 2] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:41,514 - ClientAppLogger [Client 2] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.7741
2025-08-04 21:02:41,514 - ClientAppLogger [Client 2] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.7741
2025-08-04 21:02:41,515 - ClientAppLogger [Client 2] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:41,523 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5025, Threshold=0.5578, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:02:41,523 - ClientAppLogger [Client 2] - INFO - [Client] Post-fit local evaluation F1: 0.8391
2025-08-04 21:02:41,524 - ClientAppLogger [Client 2] - INFO - Fit completed for round 166. Duration: 2.93s. Metrics: {'cpu_cores_available': 5, 'client_cid_for_attributes': '2', 'server_round': 166, 'allocated_cores_for_pytorch': 5, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.0830053057286215, 'd_loss': 0.7740860736837574, 'post_fit_local_f1': 0.8390804597701149, 'fit_time_seconds': 2.9343369007110596, 'cpu_percent_fit': 31.2125, 'ram_mb_fit': 8.3203125, 'accumulated_train_samples_this_round': 3672}
2025-08-04 21:02:41,524 - ClientAppLogger [Client 2] - INFO - [Client] get_parameters called
2025-08-04 21:02:52,856 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:52,856 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:02:52,857 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:02:52,857 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:02:52,857 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:02:52,858 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:53,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:53,263 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:53,364 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:02:53,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:02:53,410 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:53,582 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:53,593 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:53,593 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:53,645 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:02:53,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:53,666 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:02:53,667 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:53,667 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:53,667 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:02:53,676 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:53,680 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,683 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:53,685 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:53,688 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:53,690 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:53,692 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,695 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:53,698 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:53,700 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:53,702 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:53,712 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:53,712 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:02:53,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:02:53,717 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:02:53,724 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,724 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:02:53,737 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:02:53,738 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:53,754 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:53,760 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:02:53,766 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:02:53,767 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:53,767 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:53,767 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:53,767 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:53,768 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:53,768 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:02:53,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:53,768 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:02:53,768 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:53,770 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:02:53,770 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:02:53,771 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:53,771 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:02:53,771 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:53,771 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:53,771 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:53,772 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:02:53,772 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:02:53,772 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:02:53,772 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:02:53,772 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:02:53,773 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:02:53,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:02:53,774 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:02:53,774 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:02:53,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:02:53,775 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:02:53,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:02:53,775 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:53,775 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:02:53,776 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:53,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:53,779 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:53,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:02:53,780 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:02:53,780 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:02:53,780 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:02:53,791 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:02:53,791 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:53,793 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:53,793 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:02:53,795 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:53,795 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:53,795 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:53,796 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:53,805 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4869, Threshold=0.5401, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:02:53,805 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4869
2025-08-04 21:03:14,141 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:14,141 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:14,141 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:14,142 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:03:14,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:03:14,142 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:14,702 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:14,703 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:14,846 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:03:14,891 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:03:14,892 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:15,097 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:15,108 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:15,108 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:15,128 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:03:15,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:15,160 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:03:15,160 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:15,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:15,161 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:03:15,170 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:15,173 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,176 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:15,178 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:15,181 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:15,184 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:15,187 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,190 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:15,193 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:15,195 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:15,198 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:15,212 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:15,212 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:03:15,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:03:15,217 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:03:15,226 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:15,226 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:03:15,241 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:15,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:03:15,242 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:15,259 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:15,265 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:03:15,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:03:15,273 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:15,273 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:15,273 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:15,274 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:15,274 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:15,274 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:03:15,274 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:15,275 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:03:15,275 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:15,276 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:03:15,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:03:15,277 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:15,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:03:15,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:15,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:15,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:15,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:03:15,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:03:15,278 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:03:15,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:03:15,279 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:03:15,279 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:03:15,281 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:03:15,281 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:03:15,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:03:15,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:03:15,282 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:03:15,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:03:15,283 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:15,283 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:03:15,284 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:15,287 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:15,288 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:15,288 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:03:15,289 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:03:15,289 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:03:15,289 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:03:15,304 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:03:15,304 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:15,306 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:15,307 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:15,309 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:15,309 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:15,309 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:15,310 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:15,323 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5370, Threshold=0.6029, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:03:15,323 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5370
2025-08-04 21:03:32,628 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:32,629 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:32,629 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:32,629 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:03:32,629 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:03:32,629 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:32,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:32,983 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,098 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:03:33,133 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:03:33,135 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:33,271 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:33,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:33,282 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:33,292 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:03:33,308 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:33,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:03:33,310 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:33,310 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:33,311 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:03:33,323 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:33,326 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,328 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:33,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:33,333 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:33,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:33,338 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,340 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:33,344 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:33,346 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:33,349 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:33,362 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:33,362 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:03:33,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:03:33,369 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:03:33,376 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:33,377 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:03:33,394 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:33,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:03:33,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:33,412 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:33,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:03:33,429 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:03:33,430 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:33,430 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:33,430 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:33,431 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:33,431 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:33,431 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:03:33,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:33,432 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:03:33,432 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:33,434 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:03:33,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:03:33,434 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:33,434 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:03:33,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:33,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:33,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:33,435 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:03:33,435 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:03:33,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:03:33,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:03:33,436 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:03:33,436 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:03:33,438 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:03:33,438 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:03:33,438 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:03:33,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:03:33,439 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:03:33,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:03:33,439 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:33,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:03:33,440 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:33,441 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:33,441 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:33,441 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:03:33,442 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:03:33,442 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:03:33,442 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:03:33,448 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:03:33,448 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:33,449 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:33,450 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:33,451 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:33,452 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:33,452 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:33,453 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:33,462 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5230, Threshold=0.5835, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:03:33,462 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5230
2025-08-04 21:03:44,750 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:44,750 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:44,750 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:44,750 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:03:44,750 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:03:44,751 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:45,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:45,038 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:45,127 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:03:45,159 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:03:45,160 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:45,270 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:45,278 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:45,278 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:45,307 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:03:45,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:45,339 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:03:45,340 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:45,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:45,340 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:03:45,350 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:45,353 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:45,356 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:45,358 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:45,361 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:45,364 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:45,367 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:45,370 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:45,373 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:45,375 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:45,378 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:45,389 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:45,389 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:03:45,394 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:03:45,395 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:03:45,401 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:45,401 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:03:45,413 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:45,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:03:45,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:45,432 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:45,439 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:03:45,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:03:45,451 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:45,451 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:45,451 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:45,452 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:45,452 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:45,452 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:03:45,452 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:45,453 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:03:45,453 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:45,454 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:03:45,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:03:45,455 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:45,455 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:03:45,455 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:45,456 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:45,456 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:45,456 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:03:45,456 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:03:45,457 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:03:45,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:03:45,457 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:03:45,457 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:03:45,460 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:03:45,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:03:45,460 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:03:45,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:03:45,460 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:03:45,460 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:03:45,461 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:45,461 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:03:45,462 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:45,462 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:45,462 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:45,463 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:03:45,463 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:03:45,463 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:03:45,464 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:03:45,472 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:03:45,472 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:45,474 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:45,475 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:03:45,477 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:45,477 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:45,477 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:45,478 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:45,492 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.4794, Threshold=0.5102, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:03:45,493 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.4794
2025-08-04 21:03:59,775 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:59,783 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:03:59,783 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:03:59,783 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:03:59,783 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:03:59,784 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:00,060 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:00,061 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:00,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:04:00,168 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:04:00,168 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:00,270 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:00,277 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:00,277 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:00,282 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:04:00,308 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:00,308 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:04:00,309 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:00,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:00,309 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:04:00,319 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:00,322 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:00,325 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:00,327 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:00,330 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:00,332 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:00,335 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:00,337 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:00,340 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:00,342 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:00,345 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:00,356 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:00,356 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:04:00,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:04:00,361 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:04:00,368 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:00,368 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:04:00,377 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:00,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:04:00,378 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:00,395 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:00,403 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:04:00,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:04:00,410 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:00,411 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:00,411 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:00,411 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:00,411 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:00,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:04:00,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:00,412 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:04:00,412 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:00,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:04:00,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:04:00,414 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:00,414 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:04:00,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:00,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:00,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:00,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:04:00,415 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:04:00,415 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:04:00,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:04:00,416 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:04:00,416 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:04:00,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:04:00,417 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:04:00,417 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:04:00,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:04:00,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:04:00,418 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:04:00,418 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:00,419 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:04:00,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:00,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:00,419 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:00,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:04:00,420 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:04:00,420 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:04:00,420 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:04:00,427 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:04:00,427 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:00,429 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:00,429 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:04:00,431 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:00,431 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:00,431 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:00,432 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:00,440 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5447, Threshold=0.6286, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:04:00,441 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5447
2025-08-04 21:04:25,144 - ClientAppLogger [Client 2] - INFO - ClientApp starting for partition_id: 2. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:25,144 - ClientAppLogger [Client 2] - INFO - ALLOCATED_CORES='5' found. Setting PyTorch threads to 5.
2025-08-04 21:04:25,144 - ClientAppLogger [Client 2] - INFO - Called torch.set_num_threads(5). Current PyTorch intra-op threads: 5. Client will operate with 5 core(s).
2025-08-04 21:04:25,145 - ClientAppLogger [Client 2] - INFO - Loading data for partition 2/10...
2025-08-04 21:04:25,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting load_data function.
2025-08-04 21:04:25,145 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:25,617 - ClientAppLogger [Client 2] - INFO - [LoadData 2] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:25,617 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:25,722 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Numeric conversion completed.
2025-08-04 21:04:25,763 - ClientAppLogger [Client 2] - INFO - [LoadData 2] NA values filled.
2025-08-04 21:04:25,763 - ClientAppLogger [Client 2] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:25,874 - ClientAppLogger [Client 2] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,881 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,882 - ClientAppLogger [Client 2] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,897 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Scaler fitting process completed.
2025-08-04 21:04:25,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,906 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,906 - ClientAppLogger [Client 2] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,907 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting anomaly reduction logic.
2025-08-04 21:04:25,916 - ClientAppLogger [Client 2] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,919 - ClientAppLogger [Client 2] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,921 - ClientAppLogger [Client 2] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,923 - ClientAppLogger [Client 2] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,926 - ClientAppLogger [Client 2] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,930 - ClientAppLogger [Client 2] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,934 - ClientAppLogger [Client 2] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,937 - ClientAppLogger [Client 2] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,941 - ClientAppLogger [Client 2] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,943 - ClientAppLogger [Client 2] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,946 - ClientAppLogger [Client 2] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,958 - ClientAppLogger [Client 2] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,958 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Anomaly reduction logic completed.
2025-08-04 21:04:25,964 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,965 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating unlabeled training base.
2025-08-04 21:04:25,970 - ClientAppLogger [Client 2] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,970 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating labeled pool.
2025-08-04 21:04:25,981 - ClientAppLogger [Client 2] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Labeled pool creation completed.
2025-08-04 21:04:25,981 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,997 - ClientAppLogger [Client 2] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:26,002 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Combining data for final AE training set.
2025-08-04 21:04:26,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Final AE training data combination completed.
2025-08-04 21:04:26,007 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:26,007 - ClientAppLogger [Client 2] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:26,007 - ClientAppLogger [Client 2] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:26,007 - ClientAppLogger [Client 2] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:26,008 - ClientAppLogger [Client 2] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:26,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] START of partitioning block.
2025-08-04 21:04:26,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:26,008 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 1: Full indices created.
2025-08-04 21:04:26,008 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:26,012 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 2: Full indices shuffled.
2025-08-04 21:04:26,012 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Full indices shuffled.
2025-08-04 21:04:26,013 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:26,013 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Remainder distribution completed.
2025-08-04 21:04:26,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:26,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:26,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:26,014 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 6: Start indices calculated. train_start=38291
2025-08-04 21:04:26,014 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Start indices calculated. Train_start=38291, Val_start=992, Test_start=387
2025-08-04 21:04:26,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 7: End indices calculated. train_end=50650
2025-08-04 21:04:26,015 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: End indices calculated. Train_end=50650, Val_end=1114, Test_end=779
2025-08-04 21:04:26,015 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 8: Partition-specific indices extracted. Num train indices: 12359
2025-08-04 21:04:26,016 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Specific indices extracted. Train idx: 12359, Val idx: 122, Test idx: 392
2025-08-04 21:04:26,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9a: Train data sliced for partition. X_train_part_full shape: (12359, 17)
2025-08-04 21:04:26,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Train data sliced. Shape: (12359, 17)
2025-08-04 21:04:26,017 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9b: Validation data sliced for partition. X_val_part shape: (122, 17)
2025-08-04 21:04:26,017 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Validation data sliced. Shape: (122, 17)
2025-08-04 21:04:26,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 9c: Test data sliced for partition. X_test_part shape: (392, 17)
2025-08-04 21:04:26,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Partitioning: Test data sliced. Shape: (392, 17)
2025-08-04 21:04:26,018 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:26,018 - ClientAppLogger [Client 2] - INFO - [LoadData 2] Creating TonIoTDataset objects.
2025-08-04 21:04:26,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:26,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:26,019 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:26,019 - ClientAppLogger [Client 2] - INFO - [LoadData 2] TonIoTDataset objects created.
2025-08-04 21:04:26,020 - ClientAppLogger [Client 2] - INFO - Partition 2 (Static Datasets): Train Potential 12359, Val 122, Test 392
2025-08-04 21:04:26,020 - ClientAppLogger [Client 2] - INFO - [Partitioning Debug 2] END of partitioning block, returning datasets.
2025-08-04 21:04:26,020 - ClientAppLogger [Client 2] - INFO - [LoadData 2] load_data function completed.
2025-08-04 21:04:26,025 - ClientAppLogger [Client 2] - INFO - Data loaded for partition 2: Train samples: 12359, Val samples: 122
2025-08-04 21:04:26,025 - ClientAppLogger [Client 2] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:26,027 - ClientAppLogger [Client 2] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:26,027 - ClientAppLogger [Client 2] - INFO - [Client] Initialized. Device: cpu. Operating with 5 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 5.
2025-08-04 21:04:26,028 - ClientAppLogger [Client 2] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:26,029 - ClientAppLogger [Client 2] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:26,029 - ClientAppLogger [Client 2] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:26,030 - ClientAppLogger [Client 2] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:26,039 - ClientAppLogger [Client 2] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=122, Avg Anomaly Score (all samples)=0.5448, Threshold=0.6373, Accuracy=0.7705, F1=0.8391, Precision=1.0000, Recall=0.7228
2025-08-04 21:04:26,039 - ClientAppLogger [Client 2] - INFO - [Client] Evaluation finished. Samples: 122, Acc: 0.7705, F1: 0.8391, Prec: 1.0000, Rec: 0.7228, Avg Anomaly Score: 0.5448
