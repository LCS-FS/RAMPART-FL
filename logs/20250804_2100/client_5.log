2025-08-04 21:00:15,479 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:15,479 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:00:15,480 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:00:15,480 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:00:15,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:00:15,480 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:15,857 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:15,858 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:15,946 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:00:15,973 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:00:15,974 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:16,132 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:16,140 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:16,140 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:16,146 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:00:16,171 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:16,172 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:00:16,172 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:16,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:16,173 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:00:16,182 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:16,186 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,189 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:16,192 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:16,195 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:16,197 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:16,200 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:16,203 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:16,206 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:16,208 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:16,211 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:16,223 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:16,223 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:00:16,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:00:16,228 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:00:16,236 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:16,236 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:00:16,257 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:16,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:00:16,258 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:16,277 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:16,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:00:16,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:00:16,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:16,290 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:16,291 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:16,291 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:16,291 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:16,292 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:00:16,292 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:16,292 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:00:16,292 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:16,294 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:00:16,294 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:00:16,294 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:16,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:00:16,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:16,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:16,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:16,295 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:00:16,295 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:00:16,296 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:00:16,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:00:16,296 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:00:16,296 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:00:16,296 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:00:16,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:00:16,297 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:00:16,297 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:00:16,297 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:00:16,298 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:00:16,298 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:16,298 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:00:16,298 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:16,298 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:16,298 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:16,299 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:00:16,299 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:00:16,299 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:00:16,299 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:00:16,308 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:00:16,308 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:16,310 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:16,310 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:00:16,311 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:16,312 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:16,312 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:16,313 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:16,332 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5313, Threshold=0.5853, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:00:16,333 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5313
2025-08-04 21:00:39,641 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:39,641 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:00:39,641 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:00:39,642 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:00:39,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:00:39,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:39,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:39,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:40,052 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:00:40,105 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:00:40,105 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:40,259 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:40,266 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:40,266 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:40,274 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:00:40,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:40,281 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:00:40,282 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:40,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:40,282 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:00:40,291 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:40,294 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,297 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:40,299 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:40,302 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:40,305 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:40,308 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:40,310 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:40,313 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:40,316 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:40,318 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:40,331 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:40,331 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:00:40,336 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:00:40,337 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:00:40,344 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:40,344 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:00:40,356 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:40,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:00:40,357 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:40,376 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:40,382 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:00:40,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:00:40,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:40,390 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:40,390 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:40,391 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:40,391 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:40,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:00:40,392 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:40,392 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:00:40,393 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:40,394 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:00:40,394 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:00:40,395 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:40,395 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:00:40,395 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:40,395 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:40,396 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:40,396 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:00:40,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:00:40,396 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:00:40,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:00:40,397 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:00:40,397 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:00:40,397 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:00:40,397 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:00:40,398 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:00:40,398 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:00:40,398 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:00:40,398 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:00:40,399 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:40,399 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:00:40,399 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:40,400 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:40,400 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:40,400 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:00:40,400 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:00:40,400 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:00:40,401 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:00:40,408 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:00:40,408 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:40,410 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:40,410 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:00:40,412 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:40,412 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:40,412 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:40,413 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:40,436 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5169, Threshold=0.5634, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:00:40,436 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5169
2025-08-04 21:01:00,750 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:00,750 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:01:00,751 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:01:00,751 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:01:00,751 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:01:00,751 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:01,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:01,176 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:01,267 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:01:01,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:01:01,311 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:01,494 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:01,502 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:01,502 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:01,510 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:01:01,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:01,534 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:01:01,535 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:01,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:01,535 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:01:01,545 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:01,548 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,551 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:01,553 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:01,557 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:01,560 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:01,564 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:01,568 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:01,571 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:01,573 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:01,576 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:01,587 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:01,587 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:01:01,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:01:01,592 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:01:01,597 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:01,598 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:01:01,607 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:01,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:01:01,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:01,623 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:01,628 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:01:01,633 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:01:01,634 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:01,634 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:01,634 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:01,634 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:01,634 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:01,635 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:01:01,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:01,635 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:01:01,635 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:01,636 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:01:01,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:01:01,637 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:01,637 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:01:01,637 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:01,637 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:01,641 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:01,641 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:01:01,641 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:01:01,641 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:01:01,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:01:01,642 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:01:01,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:01:01,642 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:01:01,642 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:01:01,642 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:01:01,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:01:01,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:01:01,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:01:01,643 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:01,643 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:01:01,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:01,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:01,644 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:01,644 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:01:01,645 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:01:01,645 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:01:01,645 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:01:01,651 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:01:01,654 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:01,655 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:01,655 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:01:01,657 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:01,657 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:01,657 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:01,658 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:01,674 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5344, Threshold=0.5853, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:01:01,674 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5344
2025-08-04 21:01:25,025 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:25,025 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:01:25,025 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:01:25,025 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:01:25,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:01:25,025 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:25,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:25,351 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:25,445 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:01:25,488 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:01:25,488 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:25,648 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:25,656 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:25,656 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:25,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:01:25,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:25,669 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:01:25,670 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:25,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:25,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:01:25,680 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:25,683 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,685 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:25,688 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:25,691 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:25,693 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:25,697 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:25,699 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:25,702 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:25,704 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:25,707 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:25,718 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:25,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:01:25,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:01:25,723 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:01:25,728 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:25,728 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:01:25,740 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:25,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:01:25,740 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:25,760 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:25,766 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:01:25,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:01:25,781 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:25,781 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:25,781 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:25,782 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:25,782 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:25,783 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:01:25,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:25,783 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:01:25,783 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:25,784 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:01:25,784 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:01:25,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:25,785 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:01:25,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:25,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:25,785 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:01:25,786 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:01:25,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:01:25,787 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:01:25,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:01:25,787 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:01:25,787 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:25,788 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:01:25,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:25,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:25,788 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:25,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:01:25,789 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:01:25,789 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:01:25,789 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:01:25,796 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:01:25,797 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:25,798 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:25,798 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:01:25,800 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:25,800 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:25,800 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:25,801 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:25,817 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5068, Threshold=0.5496, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:01:25,817 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5068
2025-08-04 21:01:37,143 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:37,143 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:01:37,143 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:01:37,144 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:01:37,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:01:37,144 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:37,528 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:37,529 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:37,624 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:01:37,673 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:01:37,673 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:37,818 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:37,825 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:37,825 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:37,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:01:37,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:37,859 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:01:37,860 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:37,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:37,860 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:01:37,870 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:37,874 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,876 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:37,878 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:37,881 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:37,883 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:37,885 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,888 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:37,891 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:37,893 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:37,895 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:37,905 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:37,905 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:01:37,910 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:01:37,911 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:01:37,917 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:37,917 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:01:37,929 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:37,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:01:37,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:37,946 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:37,951 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:01:37,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:01:37,958 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:37,958 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:37,958 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:37,958 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:37,959 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:37,959 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:01:37,959 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:37,959 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:01:37,960 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:37,961 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:01:37,961 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:01:37,961 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:01:37,962 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:01:37,963 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:01:37,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:01:37,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:01:37,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:37,964 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:01:37,964 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:37,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:37,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:37,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:01:37,965 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:01:37,965 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:01:37,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:01:37,976 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:01:37,976 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:37,978 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:37,979 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:01:37,980 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:37,981 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:37,981 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:37,982 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:38,000 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5554, Threshold=0.6326, Accuracy=0.7435, F1=0.8207, Precision=0.9785, Recall=0.7068
2025-08-04 21:01:38,000 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7435, F1: 0.8207, Prec: 0.9785, Rec: 0.7068, Avg Anomaly Score: 0.5554
2025-08-04 21:01:43,279 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:43,280 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:01:43,280 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:01:43,280 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:01:43,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:01:43,280 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:43,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:43,650 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:43,738 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:01:43,774 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:01:43,774 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:43,887 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:43,893 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:43,893 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:43,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:01:43,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:43,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:01:43,904 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:43,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:43,904 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:01:43,912 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:43,915 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:43,917 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:43,919 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:43,922 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:43,925 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:43,927 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:43,930 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:43,933 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:43,934 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:43,937 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:43,945 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:43,945 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:01:43,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:01:43,950 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:01:43,955 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:43,955 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:01:43,965 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:43,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:01:43,965 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:43,981 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:43,985 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:01:43,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:01:43,995 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:43,995 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:43,996 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:43,996 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:43,996 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:43,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:01:43,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:43,997 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:01:43,997 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:43,999 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:01:43,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:01:43,999 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:43,999 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:01:43,999 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:01:44,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:01:44,001 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:01:44,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:01:44,001 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:01:44,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:01:44,001 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:01:44,001 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:01:44,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:44,002 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:01:44,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:44,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:44,002 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:44,002 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:01:44,003 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:01:44,003 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:01:44,003 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:01:44,009 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:01:44,009 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:44,010 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:44,010 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:01:44,012 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 163/400.
2025-08-04 21:01:44,113 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:44,113 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:44,114 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 12 anomalous samples to GAN training data (target: 12).
2025-08-04 21:01:44,115 - ClientAppLogger [Client 5] - INFO - [Client] Round 163: Training GAN with 53 samples (41 normal, 12 anomalous).
2025-08-04 21:01:44,115 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:44,165 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0863, Avg D Loss: 0.8038
2025-08-04 21:01:44,165 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0863, Avg D Loss: 0.8038
2025-08-04 21:01:44,166 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:44,181 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5181, Threshold=0.5533, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:01:44,181 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 21:01:44,181 - ClientAppLogger [Client 5] - INFO - Fit completed for round 163. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 163, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.086271503736388, 'd_loss': 0.8037883377300119, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.16952228546142578, 'cpu_percent_fit': 47.21875, 'ram_mb_fit': 8.42578125, 'accumulated_train_samples_this_round': 53}
2025-08-04 21:01:44,182 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 21:01:49,465 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:49,465 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:01:49,466 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:01:49,466 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:01:49,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:01:49,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:49,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:49,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:49,972 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:01:50,000 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:01:50,001 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:50,129 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:50,138 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:50,138 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:50,146 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:01:50,159 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:50,160 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:01:50,160 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:50,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:50,161 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:01:50,170 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:50,174 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:50,176 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:50,178 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:50,181 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:50,184 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:50,186 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:50,189 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:50,192 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:50,194 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:50,196 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:50,206 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:50,206 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:01:50,211 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:01:50,212 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:01:50,218 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:50,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:01:50,231 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:50,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:01:50,231 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:50,247 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:50,253 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:01:50,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:01:50,259 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:50,259 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:50,259 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:50,260 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:50,260 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:50,261 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:01:50,261 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:50,261 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:01:50,261 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:50,263 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:01:50,263 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:01:50,263 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:01:50,264 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:01:50,265 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:01:50,265 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:01:50,265 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:01:50,265 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:01:50,266 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:01:50,266 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:01:50,266 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:01:50,266 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:01:50,266 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:01:50,267 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:50,267 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:01:50,267 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:50,267 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:50,268 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:50,268 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:01:50,268 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:01:50,268 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:01:50,268 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:01:50,275 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:01:50,275 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:50,277 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:50,277 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:01:50,278 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:50,279 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:50,279 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:50,280 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:50,304 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4933, Threshold=0.5245, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:01:50,304 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4933
2025-08-04 21:02:10,635 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:10,636 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:02:10,636 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:02:10,636 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:02:10,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:02:10,636 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:10,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:10,993 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:11,085 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:02:11,126 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:02:11,127 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:11,311 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:11,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:11,321 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:11,333 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:02:11,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:11,342 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:02:11,343 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:11,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:11,343 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:02:11,353 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:11,356 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,359 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:11,361 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:11,365 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:11,368 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:11,371 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:11,374 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:11,377 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:11,381 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:11,385 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:11,396 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:11,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:02:11,402 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:02:11,403 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:02:11,409 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:11,409 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:02:11,422 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:11,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:02:11,422 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:11,441 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:11,447 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:02:11,456 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:02:11,456 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:11,457 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:11,457 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:11,457 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:02:11,458 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:11,460 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:02:11,460 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:02:11,461 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:11,461 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:02:11,461 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:11,461 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:11,461 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:11,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:02:11,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:02:11,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:02:11,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:02:11,462 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:02:11,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:02:11,463 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:02:11,463 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:02:11,463 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:02:11,463 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:02:11,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:02:11,464 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:02:11,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:11,464 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:02:11,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:11,464 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:11,465 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:11,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:02:11,465 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:02:11,465 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:02:11,465 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:02:11,472 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:02:11,472 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:11,473 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:11,474 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:02:11,475 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:11,476 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:11,476 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:11,476 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:11,498 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5325, Threshold=0.5863, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:02:11,498 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5325
2025-08-04 21:02:31,837 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:31,837 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:02:31,837 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:02:31,837 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:02:31,838 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:02:31,838 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:32,293 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:32,293 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:32,390 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:02:32,440 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:02:32,441 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:32,567 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:32,573 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:32,573 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:32,580 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:02:32,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:32,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:02:32,606 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:32,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:32,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:02:32,616 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:32,619 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,621 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:32,624 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:32,626 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:32,629 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:32,631 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,634 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:32,637 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:32,639 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:32,641 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:32,652 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:32,652 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:02:32,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:02:32,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:02:32,669 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:32,670 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:02:32,685 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:32,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:02:32,685 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:32,701 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:32,705 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:02:32,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:02:32,710 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:32,710 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:32,711 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:32,711 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:32,711 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:32,711 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:02:32,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:32,712 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:02:32,712 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:32,713 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:02:32,713 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:02:32,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:32,714 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:02:32,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:32,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:32,714 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:02:32,715 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:02:32,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:02:32,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:02:32,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:02:32,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:02:32,716 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:02:32,716 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:32,717 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:02:32,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:32,717 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:32,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:32,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:02:32,718 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:02:32,718 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:02:32,718 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:02:32,728 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:02:32,728 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:32,730 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:32,730 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:02:32,732 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:32,732 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:32,732 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:32,733 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:32,754 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5445, Threshold=0.5998, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:02:32,755 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5445
2025-08-04 21:02:53,131 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:53,131 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:02:53,131 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:02:53,131 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:02:53,131 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:02:53,132 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:53,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:53,516 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:53,638 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:02:53,684 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:02:53,684 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:53,809 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:53,816 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:53,816 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:53,823 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:02:53,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:53,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:02:53,832 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:53,832 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:53,833 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:02:53,842 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:53,845 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:53,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:53,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:53,855 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:53,858 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,861 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:53,864 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:53,866 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:53,869 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:53,880 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:53,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:02:53,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:02:53,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:02:53,891 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,892 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:02:53,902 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:02:53,903 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:53,921 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:53,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:02:53,935 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:02:53,936 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:53,936 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:53,936 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:53,936 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:53,937 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:53,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:02:53,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:53,937 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:02:53,937 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:53,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:02:53,939 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:02:53,939 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:53,940 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:02:53,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:53,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:53,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:53,940 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:02:53,941 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:02:53,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:02:53,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:02:53,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:02:53,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:02:53,942 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:53,942 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:02:53,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:53,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:53,943 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:53,943 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:02:53,944 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:02:53,944 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:02:53,944 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:02:53,950 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:02:53,950 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:53,952 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:53,952 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:02:53,953 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:53,953 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:53,953 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:53,954 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:53,971 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4964, Threshold=0.5307, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:02:53,971 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4964
2025-08-04 21:03:14,316 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:14,316 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:03:14,316 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:03:14,316 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:03:14,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:03:14,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:14,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:14,930 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:15,059 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:03:15,116 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:03:15,116 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:15,289 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:15,298 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:15,298 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:15,309 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:03:15,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:15,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:03:15,321 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:15,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:15,322 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:03:15,333 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:15,337 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,339 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:15,342 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:15,345 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:15,348 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:15,351 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,355 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:15,359 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:15,362 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:15,366 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:15,380 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:15,380 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:03:15,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:03:15,387 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:03:15,396 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:15,396 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:03:15,411 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:15,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:03:15,412 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:15,434 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:15,442 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:03:15,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:03:15,467 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:15,467 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:15,467 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:15,468 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:15,468 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:15,468 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:03:15,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:15,469 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:03:15,469 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:15,471 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:03:15,471 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:03:15,472 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:15,472 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:03:15,472 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:15,473 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:15,473 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:15,473 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:03:15,473 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:03:15,474 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:03:15,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:03:15,474 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:03:15,474 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:03:15,475 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:03:15,475 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:03:15,475 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:03:15,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:03:15,476 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:03:15,476 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:03:15,476 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:15,477 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:03:15,478 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:15,478 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:15,478 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:15,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:03:15,479 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:03:15,479 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:03:15,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:03:15,490 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:03:15,490 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:15,492 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:15,492 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:03:15,494 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:15,494 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:15,494 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:15,495 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:15,516 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5475, Threshold=0.6010, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:03:15,516 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5475
2025-08-04 21:03:32,831 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:32,831 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:03:32,831 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:03:32,831 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:03:32,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:03:32,831 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:33,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:33,378 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,489 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:03:33,541 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:03:33,541 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:33,729 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:33,737 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:33,737 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:33,744 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:03:33,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:33,753 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:03:33,754 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:33,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:33,754 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:03:33,765 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:33,768 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,771 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:33,773 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:33,776 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:33,778 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:33,781 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,784 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:33,787 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:33,789 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:33,791 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:33,806 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:33,806 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:03:33,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:03:33,812 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:03:33,821 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:33,821 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:03:33,839 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:33,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:03:33,840 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:33,859 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:33,864 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:03:33,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:03:33,875 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:33,875 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:33,875 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:33,875 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:33,876 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:33,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:03:33,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:33,876 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:03:33,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:33,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:03:33,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:03:33,878 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:33,878 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:03:33,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:33,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:33,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:33,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:03:33,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:03:33,879 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:03:33,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:03:33,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:03:33,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:03:33,880 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:03:33,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:03:33,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:03:33,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:03:33,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:03:33,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:03:33,881 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:33,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:03:33,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:33,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:33,882 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:33,882 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:03:33,883 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:03:33,883 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:03:33,883 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:03:33,891 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:03:33,891 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:33,892 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:33,892 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:03:33,894 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:33,894 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:33,894 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:33,895 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:33,912 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5328, Threshold=0.5805, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:03:33,913 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5328
2025-08-04 21:03:39,184 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:39,184 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:03:39,185 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:03:39,185 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:03:39,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:03:39,185 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:39,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:39,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:39,652 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:03:39,692 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:03:39,692 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:39,805 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:39,811 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:39,811 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:39,817 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:03:39,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:39,834 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:03:39,834 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:39,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:39,835 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:03:39,843 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:39,846 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:39,848 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:39,850 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:39,853 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:39,855 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:39,857 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:39,860 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:39,862 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:39,864 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:39,866 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:39,876 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:39,876 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:03:39,880 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:03:39,881 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:03:39,885 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:39,885 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:03:39,895 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:39,895 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:03:39,896 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:39,910 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:39,914 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:03:39,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:03:39,920 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:39,920 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:39,920 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:39,921 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:39,921 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:39,921 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:03:39,921 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:39,922 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:03:39,922 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:39,923 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:03:39,923 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:03:39,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:03:39,925 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:03:39,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:03:39,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:03:39,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:03:39,926 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:39,926 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:03:39,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:39,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:39,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:39,927 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:03:39,927 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:03:39,927 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:03:39,928 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:03:39,938 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:03:39,938 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:39,939 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:39,940 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:03:39,941 - ClientAppLogger [Client 5] - INFO - [Client] Fit started for round 169/400.
2025-08-04 21:03:40,042 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:40,042 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:40,043 - ClientAppLogger [Client 5] - INFO - [Client] Semi-supervised: Added 12 anomalous samples to GAN training data (target: 12).
2025-08-04 21:03:40,044 - ClientAppLogger [Client 5] - INFO - [Client] Round 169: Training GAN with 55 samples (43 normal, 12 anomalous).
2025-08-04 21:03:40,044 - ClientAppLogger [Client 5] - INFO - [Client] Starting GAN training...
2025-08-04 21:03:40,097 - ClientAppLogger [Client 5] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.7887
2025-08-04 21:03:40,097 - ClientAppLogger [Client 5] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.7887
2025-08-04 21:03:40,099 - ClientAppLogger [Client 5] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:03:40,113 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5187, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:03:40,113 - ClientAppLogger [Client 5] - INFO - [Client] Post-fit local evaluation F1: 0.8230
2025-08-04 21:03:40,114 - ClientAppLogger [Client 5] - INFO - Fit completed for round 169. Duration: 0.17s. Metrics: {'cpu_cores_available': 8, 'client_cid_for_attributes': '5', 'server_round': 169, 'allocated_cores_for_pytorch': 8, 'profile_name': 'High-End Edge CPU', 'g_loss': 2.083222750316967, 'd_loss': 0.7886726001175967, 'post_fit_local_f1': 0.8229988726042841, 'fit_time_seconds': 0.17251086235046387, 'cpu_percent_fit': 47.275, 'ram_mb_fit': 9.58203125, 'accumulated_train_samples_this_round': 55}
2025-08-04 21:03:40,114 - ClientAppLogger [Client 5] - INFO - [Client] get_parameters called
2025-08-04 21:03:45,397 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:45,397 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:03:45,397 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:03:45,397 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:03:45,397 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:03:45,398 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:45,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:45,898 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:46,006 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:03:46,048 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:03:46,048 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:46,187 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:46,197 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:46,197 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:46,204 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:03:46,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:46,218 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:03:46,218 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:46,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:46,219 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:03:46,228 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:46,232 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,234 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:46,237 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:46,241 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:46,243 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:46,247 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:46,249 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:46,252 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:46,254 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:46,257 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:46,268 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:46,268 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:03:46,273 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:03:46,273 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:03:46,278 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:46,279 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:03:46,289 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:46,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:03:46,290 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:46,306 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:46,311 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:46,317 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:46,318 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:46,318 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:03:46,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:46,319 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:03:46,319 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:46,320 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:03:46,320 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:03:46,321 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:03:46,322 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:03:46,322 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:03:46,322 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:03:46,322 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:03:46,322 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:03:46,322 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:03:46,323 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:46,323 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:03:46,324 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:46,324 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:46,324 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:46,324 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:03:46,324 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:03:46,324 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:03:46,325 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:03:46,330 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:03:46,330 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:46,331 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:46,331 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:03:46,332 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:46,333 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:46,333 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:46,333 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:46,353 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.4888, Threshold=0.5023, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:03:46,353 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.4888
2025-08-04 21:04:00,652 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:00,653 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:04:00,653 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:04:00,653 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:04:00,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:04:00,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:01,112 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:01,113 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:01,224 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:04:01,272 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:04:01,272 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:01,459 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:01,466 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:01,467 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:01,472 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:04:01,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:01,478 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:04:01,479 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:01,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:01,479 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:04:01,491 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:01,494 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,497 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:01,499 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:01,502 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:01,504 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:01,507 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,509 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:01,512 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:01,514 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:01,517 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:01,531 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:01,531 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:04:01,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:04:01,538 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:04:01,546 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:01,546 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:04:01,563 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:01,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:04:01,564 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:01,586 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:01,593 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:04:01,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:04:01,601 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:01,601 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:01,601 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:01,601 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:01,602 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:04:01,603 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:01,604 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:04:01,604 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:04:01,605 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:01,605 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:04:01,605 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:01,605 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:01,606 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:01,606 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:04:01,606 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:04:01,607 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:04:01,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:04:01,607 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:04:01,607 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:04:01,607 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:04:01,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:04:01,608 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:04:01,608 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:04:01,608 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:04:01,609 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:04:01,609 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:01,609 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:04:01,610 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:01,610 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:01,610 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:01,610 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:04:01,610 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:04:01,611 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:04:01,611 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:04:01,619 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:04:01,619 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:01,621 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:01,621 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:04:01,622 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:01,623 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:01,623 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:01,623 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:01,638 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5548, Threshold=0.6231, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:04:01,638 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5548
2025-08-04 21:04:15,923 - ClientAppLogger [Client 5] - INFO - ClientApp starting for partition_id: 5. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:15,923 - ClientAppLogger [Client 5] - INFO - ALLOCATED_CORES='8' found. Setting PyTorch threads to 8.
2025-08-04 21:04:15,923 - ClientAppLogger [Client 5] - INFO - Called torch.set_num_threads(8). Current PyTorch intra-op threads: 8. Client will operate with 8 core(s).
2025-08-04 21:04:15,923 - ClientAppLogger [Client 5] - INFO - Loading data for partition 5/10...
2025-08-04 21:04:15,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting load_data function.
2025-08-04 21:04:15,924 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:22,462 - ClientAppLogger [Client 5] - INFO - [LoadData 5] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:22,464 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:22,581 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Numeric conversion completed.
2025-08-04 21:04:22,616 - ClientAppLogger [Client 5] - INFO - [LoadData 5] NA values filled.
2025-08-04 21:04:22,616 - ClientAppLogger [Client 5] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:22,807 - ClientAppLogger [Client 5] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:22,818 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:22,819 - ClientAppLogger [Client 5] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:22,830 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Scaler fitting process completed.
2025-08-04 21:04:22,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:22,877 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting semi-supervised data splitting logic.
2025-08-04 21:04:22,878 - ClientAppLogger [Client 5] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:22,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:22,879 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting anomaly reduction logic.
2025-08-04 21:04:23,796 - ClientAppLogger [Client 5] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:23,802 - ClientAppLogger [Client 5] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:23,805 - ClientAppLogger [Client 5] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:23,809 - ClientAppLogger [Client 5] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:23,813 - ClientAppLogger [Client 5] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:23,816 - ClientAppLogger [Client 5] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:23,820 - ClientAppLogger [Client 5] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:23,823 - ClientAppLogger [Client 5] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:23,827 - ClientAppLogger [Client 5] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:23,831 - ClientAppLogger [Client 5] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:23,835 - ClientAppLogger [Client 5] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:24,081 - ClientAppLogger [Client 5] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:24,081 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Anomaly reduction logic completed.
2025-08-04 21:04:24,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Normal and anomaly indices shuffled.
2025-08-04 21:04:24,088 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating unlabeled training base.
2025-08-04 21:04:24,210 - ClientAppLogger [Client 5] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:24,211 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating labeled pool.
2025-08-04 21:04:24,226 - ClientAppLogger [Client 5] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:24,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Labeled pool creation completed.
2025-08-04 21:04:24,226 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:24,430 - ClientAppLogger [Client 5] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:24,437 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Combining data for final AE training set.
2025-08-04 21:04:24,552 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Final AE training data combination completed.
2025-08-04 21:04:24,653 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:24,653 - ClientAppLogger [Client 5] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:24,653 - ClientAppLogger [Client 5] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:24,654 - ClientAppLogger [Client 5] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:24,654 - ClientAppLogger [Client 5] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:24,654 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] START of partitioning block.
2025-08-04 21:04:24,654 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:24,655 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 1: Full indices created.
2025-08-04 21:04:24,655 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:24,657 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 2: Full indices shuffled.
2025-08-04 21:04:24,657 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Full indices shuffled.
2025-08-04 21:04:24,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:24,661 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Remainder distribution completed.
2025-08-04 21:04:24,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:24,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:24,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:24,661 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 6: Start indices calculated. train_start=52919
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Start indices calculated. Train_start=52919, Val_start=4264, Test_start=4591
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 7: End indices calculated. train_end=53088
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: End indices calculated. Train_end=53088, Val_end=4884, Test_end=5190
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 8: Partition-specific indices extracted. Num train indices: 169
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Specific indices extracted. Train idx: 169, Val idx: 620, Test idx: 599
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9a: Train data sliced for partition. X_train_part_full shape: (169, 17)
2025-08-04 21:04:24,662 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Train data sliced. Shape: (169, 17)
2025-08-04 21:04:24,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9b: Validation data sliced for partition. X_val_part shape: (620, 17)
2025-08-04 21:04:24,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Validation data sliced. Shape: (620, 17)
2025-08-04 21:04:24,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 9c: Test data sliced for partition. X_test_part shape: (599, 17)
2025-08-04 21:04:24,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Partitioning: Test data sliced. Shape: (599, 17)
2025-08-04 21:04:24,663 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:24,663 - ClientAppLogger [Client 5] - INFO - [LoadData 5] Creating TonIoTDataset objects.
2025-08-04 21:04:24,694 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:24,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:24,698 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:24,699 - ClientAppLogger [Client 5] - INFO - [LoadData 5] TonIoTDataset objects created.
2025-08-04 21:04:24,702 - ClientAppLogger [Client 5] - INFO - Partition 5 (Static Datasets): Train Potential 169, Val 620, Test 599
2025-08-04 21:04:24,702 - ClientAppLogger [Client 5] - INFO - [Partitioning Debug 5] END of partitioning block, returning datasets.
2025-08-04 21:04:24,702 - ClientAppLogger [Client 5] - INFO - [LoadData 5] load_data function completed.
2025-08-04 21:04:24,714 - ClientAppLogger [Client 5] - INFO - Data loaded for partition 5: Train samples: 169, Val samples: 620
2025-08-04 21:04:24,714 - ClientAppLogger [Client 5] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:24,726 - ClientAppLogger [Client 5] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:24,728 - ClientAppLogger [Client 5] - INFO - [Client] Initialized. Device: cpu. Operating with 8 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 8.
2025-08-04 21:04:24,732 - ClientAppLogger [Client 5] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:24,732 - ClientAppLogger [Client 5] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:24,732 - ClientAppLogger [Client 5] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:24,734 - ClientAppLogger [Client 5] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:24,920 - ClientAppLogger [Client 5] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=620, Avg Anomaly Score (all samples)=0.5548, Threshold=0.6279, Accuracy=0.7468, F1=0.8230, Precision=0.9812, Recall=0.7087
2025-08-04 21:04:24,920 - ClientAppLogger [Client 5] - INFO - [Client] Evaluation finished. Samples: 620, Acc: 0.7468, F1: 0.8230, Prec: 0.9812, Rec: 0.7087, Avg Anomaly Score: 0.5548
