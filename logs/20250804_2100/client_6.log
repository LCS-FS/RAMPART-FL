2025-08-04 21:00:17,571 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:17,571 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:17,571 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:17,572 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:00:17,572 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:00:17,572 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:17,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:17,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:18,065 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:00:18,105 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:00:18,105 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:18,273 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:18,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:18,279 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:18,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:00:18,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:18,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:00:18,292 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:18,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:18,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:00:18,301 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:18,304 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:18,306 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:18,309 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:18,312 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:18,314 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:18,317 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:18,320 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:18,322 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:18,325 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:18,328 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:18,338 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:18,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:00:18,344 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:00:18,345 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:00:18,350 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:18,350 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:00:18,361 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:18,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:00:18,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:18,380 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:18,385 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:00:18,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:00:18,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:18,392 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:18,392 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:18,392 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:18,393 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:18,393 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:00:18,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:18,393 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:00:18,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:18,395 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:00:18,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:00:18,395 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:00:18,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:00:18,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:00:18,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:00:18,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:00:18,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:18,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:00:18,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:18,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:18,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:18,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:00:18,399 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:00:18,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:00:18,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:00:18,408 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:00:18,408 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:18,409 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:18,409 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:18,411 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:18,411 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:18,411 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:18,411 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:18,419 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5471, Threshold=0.5909, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:00:18,419 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5471
2025-08-04 21:00:23,680 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:23,680 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:23,680 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:23,680 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:00:23,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:00:23,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:24,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:24,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:24,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:00:24,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:00:24,157 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:24,281 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:24,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:24,287 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:24,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:00:24,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:24,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:00:24,298 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:24,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:24,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:00:24,306 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:24,309 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:24,312 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:24,314 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:24,316 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:24,319 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:24,322 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:24,324 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:24,327 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:24,329 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:24,332 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:24,341 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:24,341 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:00:24,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:00:24,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:00:24,350 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:24,350 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:00:24,359 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:24,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:00:24,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:24,376 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:24,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:00:24,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:00:24,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:24,392 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:24,392 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:24,392 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:24,393 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:24,393 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:00:24,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:24,393 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:00:24,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:24,395 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:00:24,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:00:24,395 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:00:24,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:00:24,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:00:24,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:00:24,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:24,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:00:24,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:24,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:24,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:24,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:00:24,399 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:00:24,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:00:24,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:00:24,407 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:00:24,407 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:24,408 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:24,408 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:24,410 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 159/400.
2025-08-04 21:00:24,511 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:24,511 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:24,514 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:00:24,514 - ClientAppLogger [Client 6] - INFO - [Client] Round 159: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 21:00:24,514 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 21:00:24,568 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0827, Avg D Loss: 0.7963
2025-08-04 21:00:24,568 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0827, Avg D Loss: 0.7963
2025-08-04 21:00:24,568 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:00:24,576 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5970, Threshold=0.6553, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 21:00:24,576 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 21:00:24,577 - ClientAppLogger [Client 6] - INFO - Fit completed for round 159. Duration: 0.17s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 159, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0826688183678526, 'd_loss': 0.7962997860378689, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.1667938232421875, 'cpu_percent_fit': 11.45, 'ram_mb_fit': 8.79296875, 'accumulated_train_samples_this_round': 36}
2025-08-04 21:00:24,577 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 21:00:38,874 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:38,874 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:38,874 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:38,874 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:00:38,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:00:38,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:00:39,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:00:39,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:00:39,328 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:00:39,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:00:39,367 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:00:39,512 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:00:39,519 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:00:39,519 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:00:39,528 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:00:39,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:00:39,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:00:39,552 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:00:39,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:00:39,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:00:39,561 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:00:39,565 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:39,567 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:00:39,569 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:00:39,572 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:00:39,574 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:00:39,577 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:00:39,580 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:00:39,582 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:00:39,584 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:00:39,587 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:00:39,597 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:00:39,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:00:39,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:00:39,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:00:39,610 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:00:39,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:00:39,622 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:00:39,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:00:39,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:00:39,639 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:00:39,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:00:39,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:00:39,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:00:39,654 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:00:39,654 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:00:39,654 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:00:39,654 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:00:39,655 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:00:39,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:00:39,655 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:00:39,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:00:39,657 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:00:39,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:00:39,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:00:39,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:00:39,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:00:39,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:00:39,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:00:39,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:00:39,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:00:39,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:00:39,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:00:39,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:00:39,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:00:39,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:00:39,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:00:39,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:00:39,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:00:39,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:00:39,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:00:39,662 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:00:39,662 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:00:39,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:00:39,672 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:00:39,672 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:00:39,673 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:00:39,673 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:00:39,675 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:00:39,675 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:00:39,675 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:00:39,676 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:00:39,684 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5304, Threshold=0.5669, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:00:39,684 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5304
2025-08-04 21:00:59,969 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:00:59,969 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:00:59,969 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:00:59,969 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:00:59,969 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:00:59,970 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:00,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:00,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:00,449 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:01:00,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:01:00,494 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:00,664 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:00,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:00,671 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:00,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:01:00,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:00,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:01:00,686 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:00,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:00,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:01:00,696 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:00,699 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:00,701 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:00,704 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:00,707 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:00,709 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:00,712 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:00,715 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:00,718 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:00,720 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:00,722 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:00,732 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:00,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:01:00,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:01:00,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:01:00,743 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:00,743 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:01:00,752 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:00,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:01:00,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:00,769 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:00,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:01:00,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:01:00,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:00,785 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:00,785 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:00,785 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:00,786 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:00,786 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:01:00,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:00,786 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:01:00,787 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:00,788 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:01:00,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:01:00,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:01:00,790 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:01:00,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:01:00,790 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:01:00,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:01:00,790 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:01:00,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:01:00,791 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:01:00,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:01:00,791 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:01:00,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:01:00,791 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:00,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:01:00,792 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:00,792 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:00,792 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:00,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:01:00,792 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:01:00,792 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:01:00,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:01:00,802 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:01:00,802 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:00,803 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:00,803 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:00,805 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:00,805 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:00,805 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:00,806 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:00,814 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5492, Threshold=0.5875, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:01:00,814 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5492
2025-08-04 21:01:24,112 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:24,112 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:24,112 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:24,112 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:01:24,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:01:24,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:24,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:24,452 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:24,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:01:24,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:01:24,593 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:24,755 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:24,763 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:24,763 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:24,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:01:24,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:24,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:01:24,776 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:24,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:24,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:01:24,786 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:24,790 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:24,792 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:24,794 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:24,798 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:24,801 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:24,805 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:24,808 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:24,811 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:24,813 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:24,816 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:24,829 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:24,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:01:24,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:01:24,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:01:24,843 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:24,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:01:24,852 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:24,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:01:24,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:24,869 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:24,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:01:24,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:01:24,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:24,881 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:24,881 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:24,881 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:24,881 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:24,882 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:01:24,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:24,882 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:01:24,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:24,884 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:01:24,884 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:01:24,885 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:24,885 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:01:24,885 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:24,885 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:24,885 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:24,885 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:01:24,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:01:24,887 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:01:24,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:01:24,887 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:01:24,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:01:24,887 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:24,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:01:24,888 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:24,888 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:24,888 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:24,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:01:24,888 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:01:24,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:01:24,889 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:01:24,899 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:01:24,899 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:24,900 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:24,900 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:24,902 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:24,902 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:24,902 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:24,903 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:24,911 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5189, Threshold=0.5537, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:01:24,911 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5189
2025-08-04 21:01:30,173 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:30,173 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:30,173 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:30,173 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:01:30,174 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:01:30,174 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:30,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:30,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:30,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:01:30,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:01:30,673 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:30,800 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:30,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:30,806 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:30,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:01:30,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:30,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:01:30,831 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:30,831 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:30,831 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:01:30,839 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:30,842 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:30,844 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:30,847 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:30,850 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:30,852 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:30,854 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:30,857 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:30,860 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:30,862 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:30,865 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:30,875 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:30,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:01:30,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:01:30,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:01:30,885 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:30,885 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:01:30,894 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:30,894 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:01:30,895 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:30,910 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:30,915 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:01:30,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:01:30,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:30,920 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:30,921 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:30,921 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:30,921 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:30,922 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:01:30,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:30,922 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:01:30,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:30,924 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:01:30,924 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:01:30,924 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:30,924 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:01:30,924 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:30,924 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:01:30,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:01:30,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:30,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:30,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:30,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:01:30,927 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:01:30,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:01:30,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:01:30,938 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:01:30,938 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:30,939 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:30,939 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:30,941 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 162/400.
2025-08-04 21:01:31,041 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:31,042 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:31,043 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:01:31,043 - ClientAppLogger [Client 6] - INFO - [Client] Round 162: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 21:01:31,043 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 21:01:31,090 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.7949
2025-08-04 21:01:31,090 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.7949
2025-08-04 21:01:31,090 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:01:31,098 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5760, Threshold=0.6375, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 21:01:31,099 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 21:01:31,099 - ClientAppLogger [Client 6] - INFO - Fit completed for round 162. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 162, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0833152267667985, 'd_loss': 0.7949198358588749, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.15793991088867188, 'cpu_percent_fit': 11.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 36}
2025-08-04 21:01:31,099 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 21:01:36,387 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:36,387 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:36,387 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:36,387 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:01:36,388 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:01:36,388 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:36,841 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:36,841 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:36,946 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:01:36,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:01:36,997 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:37,165 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:37,173 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:37,173 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:37,178 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:01:37,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:37,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:01:37,185 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:37,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:37,186 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:01:37,195 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:37,198 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,200 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:37,203 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:37,206 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:37,209 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:37,212 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:37,215 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:37,218 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:37,220 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:37,222 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:37,232 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:37,232 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:01:37,237 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:01:37,237 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:01:37,243 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:37,243 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:01:37,255 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:37,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:01:37,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:37,273 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:37,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:01:37,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:01:37,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:37,285 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:37,286 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:37,286 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:37,286 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:37,287 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:01:37,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:37,287 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:01:37,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:37,289 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:01:37,289 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:01:37,290 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:37,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:01:37,290 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:37,290 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:37,290 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:01:37,291 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:01:37,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:01:37,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:01:37,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:01:37,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:01:37,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:01:37,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:37,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:01:37,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:37,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:37,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:37,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:01:37,294 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:01:37,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:01:37,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:01:37,300 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:01:37,300 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:37,301 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:37,301 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:37,303 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:37,303 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:37,303 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:37,304 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:37,313 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5760, Threshold=0.6375, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 21:01:37,313 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5760
2025-08-04 21:01:48,593 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:01:48,593 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:01:48,593 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:01:48,593 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:01:48,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:01:48,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:01:49,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:01:49,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:01:49,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:01:49,143 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:01:49,143 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:01:49,279 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:01:49,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:01:49,285 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:01:49,289 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:01:49,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:01:49,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:01:49,296 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:01:49,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:01:49,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:01:49,305 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:01:49,308 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:49,311 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:01:49,313 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:01:49,316 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:01:49,318 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:01:49,320 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:01:49,323 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:01:49,326 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:01:49,328 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:01:49,331 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:01:49,341 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:01:49,341 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:01:49,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:01:49,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:01:49,353 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:01:49,353 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:01:49,367 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:01:49,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:01:49,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:01:49,385 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:01:49,390 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:01:49,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:01:49,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:01:49,396 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:01:49,396 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:01:49,396 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:01:49,397 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:01:49,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:01:49,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:01:49,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:01:49,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:01:49,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:01:49,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:01:49,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:01:49,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:01:49,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:01:49,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:01:49,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:01:49,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:01:49,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:01:49,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:01:49,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:01:49,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:01:49,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:01:49,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:01:49,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:01:49,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:01:49,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:01:49,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:01:49,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:01:49,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:01:49,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:01:49,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:01:49,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:01:49,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:01:49,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:01:49,404 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:01:49,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:01:49,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:01:49,409 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:01:49,409 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:01:49,410 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:01:49,410 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:01:49,412 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:01:49,412 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:01:49,412 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:01:49,413 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:01:49,421 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5024, Threshold=0.5243, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:01:49,422 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5024
2025-08-04 21:02:09,714 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:09,715 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:09,715 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:09,715 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:02:09,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:02:09,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:10,091 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:10,091 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:10,180 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:02:10,233 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:02:10,233 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:10,372 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:10,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:10,380 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:10,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:02:10,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:10,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:02:10,475 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:10,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:10,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:02:10,486 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:10,489 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,492 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:10,495 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:10,498 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:10,500 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:10,503 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:10,506 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:10,508 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:10,510 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:10,514 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:10,526 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:10,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:02:10,531 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:02:10,531 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:02:10,539 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:10,539 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:02:10,550 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:10,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:02:10,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:10,567 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:10,572 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:02:10,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:02:10,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:10,578 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:10,578 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:10,579 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:10,579 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:10,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:02:10,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:10,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:02:10,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:10,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:02:10,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:02:10,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:10,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:02:10,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:10,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:10,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:10,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:02:10,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:02:10,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:02:10,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:02:10,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:02:10,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:02:10,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:02:10,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:02:10,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:02:10,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:02:10,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:02:10,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:02:10,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:10,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:02:10,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:10,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:10,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:10,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:02:10,586 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:02:10,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:02:10,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:02:10,595 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:02:10,596 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:10,597 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:10,597 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:10,599 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:10,599 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:10,599 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:10,600 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:10,608 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5478, Threshold=0.5889, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:02:10,608 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5478
2025-08-04 21:02:15,866 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:15,866 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:15,866 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:15,866 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:02:15,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:02:15,867 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:16,209 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:16,209 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:16,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:02:16,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:02:16,346 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:16,463 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:16,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:16,469 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:16,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:02:16,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:16,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:02:16,480 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:16,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:16,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:02:16,488 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:16,491 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:16,494 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:16,496 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:16,499 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:16,501 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:16,504 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:16,506 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:16,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:16,511 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:16,514 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:16,525 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:16,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:02:16,530 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:02:16,530 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:02:16,535 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:16,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:02:16,544 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:16,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:02:16,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:16,560 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:16,565 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:02:16,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:02:16,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:16,576 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:16,577 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:16,577 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:16,577 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:16,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:02:16,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:16,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:02:16,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:16,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:02:16,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:02:16,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:02:16,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:02:16,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:02:16,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:02:16,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:16,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:02:16,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:16,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:16,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:16,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:02:16,583 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:02:16,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:02:16,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:02:16,591 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:02:16,591 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:16,592 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:16,593 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:16,594 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 165/400.
2025-08-04 21:02:16,695 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:16,695 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:16,697 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:02:16,697 - ClientAppLogger [Client 6] - INFO - [Client] Round 165: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 21:02:16,697 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:16,747 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0896, Avg D Loss: 0.7945
2025-08-04 21:02:16,747 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0896, Avg D Loss: 0.7945
2025-08-04 21:02:16,747 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:16,756 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5157, Threshold=0.5664, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:02:16,756 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 21:02:16,757 - ClientAppLogger [Client 6] - INFO - Fit completed for round 165. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 165, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.089566797680325, 'd_loss': 0.7944821443822648, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.16260218620300293, 'cpu_percent_fit': 11.15625, 'ram_mb_fit': 3.6171875, 'accumulated_train_samples_this_round': 36}
2025-08-04 21:02:16,757 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 21:02:31,056 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:31,056 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:31,056 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:31,056 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:02:31,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:02:31,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:31,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:31,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:31,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:02:31,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:02:31,747 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:31,955 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:31,964 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:31,964 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:31,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:02:31,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:31,988 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:02:31,989 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:31,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:31,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:02:31,998 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:32,002 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,005 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:32,008 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:32,011 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:32,013 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:32,016 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:32,019 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:32,021 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:32,024 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:32,026 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:32,040 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:32,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:02:32,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:02:32,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:02:32,052 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:32,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:02:32,066 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:32,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:02:32,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:32,088 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:32,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:02:32,105 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:02:32,105 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:32,105 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:32,105 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:32,106 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:32,106 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:32,106 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:02:32,106 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:32,107 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:02:32,107 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:32,108 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:02:32,109 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:02:32,109 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:32,109 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:02:32,109 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:32,110 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:32,110 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:32,110 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:02:32,110 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:02:32,111 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:02:32,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:02:32,111 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:02:32,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:02:32,111 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:02:32,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:02:32,112 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:02:32,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:02:32,112 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:02:32,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:02:32,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:32,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:02:32,113 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:32,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:32,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:32,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:02:32,114 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:02:32,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:02:32,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:02:32,124 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:02:32,124 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:32,126 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:32,126 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:32,128 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:32,128 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:32,128 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:32,129 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:32,146 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5599, Threshold=0.6042, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:02:32,146 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5599
2025-08-04 21:02:52,476 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:52,477 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:52,477 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:52,477 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:02:52,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:02:52,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:53,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:53,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:53,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:02:53,203 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:02:53,203 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:53,355 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:53,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:53,367 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:53,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:02:53,422 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:53,422 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:02:53,423 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:53,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:53,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:02:53,435 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:53,439 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,441 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:53,444 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:53,448 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:53,450 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:53,453 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:53,456 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:53,459 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:53,461 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:53,464 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:53,478 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:53,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:02:53,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:02:53,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:02:53,497 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:53,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:02:53,522 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:53,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:02:53,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:53,548 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:53,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:02:53,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:02:53,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:53,571 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:53,571 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:53,572 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:53,572 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:53,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:02:53,573 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:53,573 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:02:53,574 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:53,576 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:02:53,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:02:53,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:53,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:02:53,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:53,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:53,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:53,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:02:53,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:02:53,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:02:53,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:02:53,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:02:53,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:02:53,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:02:53,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:02:53,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:02:53,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:02:53,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:02:53,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:02:53,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:53,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:02:53,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:53,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:53,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:53,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:02:53,582 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:02:53,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:02:53,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:02:53,601 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:02:53,601 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:53,602 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:53,603 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:53,604 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:02:53,605 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:53,605 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:53,605 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:02:53,615 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5067, Threshold=0.5316, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:02:53,615 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5067
2025-08-04 21:02:58,899 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:02:58,899 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:02:58,899 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:02:58,899 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:02:58,899 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:02:58,899 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:02:59,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:02:59,316 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:02:59,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:02:59,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:02:59,456 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:02:59,607 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:02:59,614 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:02:59,614 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:02:59,620 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:02:59,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:02:59,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:02:59,627 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:02:59,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:02:59,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:02:59,636 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:02:59,639 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:59,642 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:02:59,644 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:02:59,647 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:02:59,649 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:02:59,651 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:02:59,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:02:59,657 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:02:59,659 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:02:59,662 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:02:59,674 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:02:59,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:02:59,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:02:59,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:02:59,685 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:02:59,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:02:59,695 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:02:59,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:02:59,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:02:59,713 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:02:59,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:02:59,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:02:59,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:02:59,732 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:02:59,733 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:02:59,733 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:02:59,733 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:02:59,734 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:02:59,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:02:59,734 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:02:59,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:02:59,736 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:02:59,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:02:59,736 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:02:59,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:02:59,736 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:02:59,736 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:02:59,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:02:59,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:02:59,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:02:59,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:02:59,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:02:59,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:02:59,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:02:59,740 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:02:59,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:02:59,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:02:59,748 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:02:59,748 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:02:59,749 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:02:59,750 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:02:59,752 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 167/400.
2025-08-04 21:02:59,852 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:02:59,853 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:02:59,854 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:02:59,854 - ClientAppLogger [Client 6] - INFO - [Client] Round 167: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 21:02:59,854 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 21:02:59,906 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0846, Avg D Loss: 0.8021
2025-08-04 21:02:59,906 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0846, Avg D Loss: 0.8021
2025-08-04 21:02:59,907 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:02:59,915 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5519, Threshold=0.6003, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:02:59,915 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 21:02:59,915 - ClientAppLogger [Client 6] - INFO - Fit completed for round 167. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 167, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0846209473080104, 'd_loss': 0.8020647651619381, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.163771390914917, 'cpu_percent_fit': 11.875, 'ram_mb_fit': 10.1328125, 'accumulated_train_samples_this_round': 36}
2025-08-04 21:02:59,916 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 21:03:14,234 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:14,234 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:14,234 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:14,234 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:03:14,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:03:14,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:14,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:14,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:14,937 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:03:14,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:03:14,993 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:15,144 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:15,151 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:15,151 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:15,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:03:15,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:15,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:03:15,224 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:15,224 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:15,224 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:03:15,235 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:15,238 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,241 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:15,243 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:15,246 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:15,248 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:15,251 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:15,253 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:15,256 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:15,258 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:15,261 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:15,273 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:15,273 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:03:15,280 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:03:15,280 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:03:15,289 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:15,289 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:03:15,316 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:15,319 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:03:15,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:15,341 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:15,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:03:15,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:03:15,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:15,361 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:15,361 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:15,362 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:15,363 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:15,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:03:15,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:15,364 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:03:15,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:15,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:03:15,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:03:15,367 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:15,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:03:15,367 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:15,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:15,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:15,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:03:15,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:03:15,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:03:15,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:03:15,369 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:03:15,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:03:15,369 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:03:15,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:03:15,370 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:03:15,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:03:15,370 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:03:15,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:03:15,371 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:15,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:03:15,372 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:15,372 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:15,373 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:15,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:03:15,373 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:03:15,373 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:03:15,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:03:15,388 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:03:15,388 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:15,391 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:15,392 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:15,394 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:15,394 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:15,394 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:15,395 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:15,407 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5613, Threshold=0.6006, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:03:15,407 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5613
2025-08-04 21:03:32,711 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:32,711 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:32,712 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:32,712 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:03:32,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:03:32,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:33,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:33,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:33,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:03:33,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:03:33,430 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:33,657 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:33,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:33,669 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:33,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:03:33,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:33,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:03:33,696 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:33,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:33,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:03:33,708 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:33,711 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,713 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:33,715 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:33,718 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:33,720 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:33,723 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:33,726 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:33,729 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:33,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:33,734 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:33,747 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:33,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:03:33,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:03:33,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:03:33,763 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:33,763 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:03:33,778 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:33,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:03:33,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:33,800 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:33,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:03:33,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:03:33,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:33,818 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:33,818 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:33,819 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:33,819 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:33,819 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:03:33,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:33,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:03:33,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:33,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:03:33,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:03:33,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:33,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:03:33,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:33,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:33,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:33,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:03:33,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:03:33,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:03:33,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:03:33,825 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:03:33,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:03:33,825 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:03:33,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:03:33,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:03:33,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:03:33,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:03:33,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:03:33,827 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:33,827 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:03:33,828 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:33,828 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:33,829 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:33,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:03:33,830 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:03:33,831 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:03:33,831 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:03:33,840 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:03:33,840 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:33,842 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:33,842 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:33,844 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:33,844 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:33,844 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:33,845 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:33,854 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5452, Threshold=0.5799, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:03:33,854 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5452
2025-08-04 21:03:45,156 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:03:45,156 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:03:45,156 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:03:45,156 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:03:45,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:03:45,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:03:45,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:03:45,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:03:45,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:03:45,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:03:45,776 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:03:45,920 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:03:45,928 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:03:45,928 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:03:45,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:03:45,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:03:45,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:03:45,950 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:03:45,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:03:45,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:03:45,960 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:03:45,963 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:45,966 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:03:45,968 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:03:45,971 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:03:45,973 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:03:45,976 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:03:45,979 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:03:45,982 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:03:45,984 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:03:45,987 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:03:45,998 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:03:45,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:03:46,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:03:46,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:03:46,010 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:03:46,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:03:46,028 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:03:46,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:03:46,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:03:46,051 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:03:46,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:03:46,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:03:46,064 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:03:46,064 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:03:46,064 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:03:46,065 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:03:46,065 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:03:46,065 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:03:46,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:03:46,066 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:03:46,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:03:46,068 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:03:46,068 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:03:46,069 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:03:46,069 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:03:46,069 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:03:46,069 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:03:46,070 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:03:46,070 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:03:46,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:03:46,071 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:03:46,071 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:03:46,071 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:03:46,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:03:46,072 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:03:46,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:03:46,072 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:03:46,073 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:03:46,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:03:46,073 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:03:46,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:03:46,073 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:03:46,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:03:46,074 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:03:46,074 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:03:46,074 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:03:46,074 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:03:46,075 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:03:46,075 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:03:46,083 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:03:46,083 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:03:46,085 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:03:46,085 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:03:46,087 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:03:46,087 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:03:46,087 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:03:46,088 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:03:46,097 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4931, Threshold=0.5005, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:03:46,097 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4931
2025-08-04 21:04:00,374 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:00,374 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:04:00,374 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:04:00,374 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:04:00,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:04:00,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:00,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:00,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:00,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:04:00,960 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:04:00,964 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:01,155 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:01,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:01,162 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:01,170 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:04:01,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:01,189 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:04:01,189 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:01,189 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:01,190 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:04:01,201 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:01,205 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,208 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:01,211 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:01,214 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:01,217 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:01,220 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:01,222 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:01,226 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:01,230 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:01,233 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:01,248 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:01,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:04:01,255 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:04:01,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:04:01,261 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:01,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:04:01,275 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:01,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:04:01,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:01,294 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:01,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:04:01,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:04:01,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:01,307 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:01,307 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:01,308 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:01,308 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:01,308 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:04:01,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:01,309 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:04:01,309 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:01,310 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:04:01,310 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:04:01,312 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:01,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:04:01,314 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:01,314 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:04:01,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:04:01,316 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:04:01,316 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:04:01,316 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:04:01,316 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:04:01,316 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:04:01,316 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:04:01,317 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:01,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:04:01,338 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:01,339 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:01,339 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:01,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:04:01,340 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:04:01,340 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:04:01,341 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:04:01,347 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:04:01,348 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:01,357 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:01,359 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:04:01,363 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:01,363 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:01,363 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:01,365 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:01,410 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5702, Threshold=0.6246, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:04:01,411 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5702
2025-08-04 21:04:09,677 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:09,678 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:04:09,678 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:04:09,678 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:04:09,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:04:09,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:10,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:10,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:10,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:04:10,182 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:04:10,182 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:10,305 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:10,311 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:10,311 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:10,316 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:04:10,321 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:10,321 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:04:10,322 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:10,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:10,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:04:10,330 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:10,333 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:10,335 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:10,337 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:10,340 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:10,342 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:10,345 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:10,347 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:10,350 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:10,352 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:10,354 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:10,363 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:10,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:04:10,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:04:10,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:04:10,373 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:10,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:04:10,381 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:10,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:04:10,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:10,396 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:10,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:04:10,410 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:04:10,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:10,411 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:10,411 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:10,411 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:10,411 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:10,411 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:04:10,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:10,412 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:04:10,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:10,413 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:04:10,414 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:04:10,414 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:10,414 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:04:10,414 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:10,414 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:10,414 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:04:10,415 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:04:10,416 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:10,417 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:10,417 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:10,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:04:10,417 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:04:10,417 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:04:10,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:04:10,426 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:04:10,426 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:10,427 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:10,427 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:04:10,429 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 171/400.
2025-08-04 21:04:10,530 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:10,530 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:10,532 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 21:04:10,532 - ClientAppLogger [Client 6] - INFO - [Client] Round 171: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 21:04:10,532 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 21:04:10,579 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0801, Avg D Loss: 0.8085
2025-08-04 21:04:10,580 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0801, Avg D Loss: 0.8085
2025-08-04 21:04:10,580 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 21:04:10,587 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.6537, Threshold=0.7385, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 21:04:10,587 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 21:04:10,588 - ClientAppLogger [Client 6] - INFO - Fit completed for round 171. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 171, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.080054447386, 'd_loss': 0.808463356229994, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.15857243537902832, 'cpu_percent_fit': 11.9875, 'ram_mb_fit': 8.49609375, 'accumulated_train_samples_this_round': 36}
2025-08-04 21:04:10,588 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 21:04:15,855 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2100
2025-08-04 21:04:15,855 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 21:04:15,855 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 21:04:15,855 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 21:04:15,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 21:04:15,856 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 21:04:22,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 21:04:22,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 21:04:22,628 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 21:04:22,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 21:04:22,687 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 21:04:24,787 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 21:04:25,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 21:04:25,015 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 21:04:25,133 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 21:04:25,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 21:04:25,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 21:04:25,252 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 21:04:25,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 21:04:25,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 21:04:25,266 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 21:04:25,271 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,277 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 21:04:25,280 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 21:04:25,285 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 21:04:25,289 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 21:04:25,293 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 21:04:25,296 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 21:04:25,300 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 21:04:25,303 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 21:04:25,308 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 21:04:25,325 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 21:04:25,326 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 21:04:25,333 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 21:04:25,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 21:04:25,349 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 21:04:25,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 21:04:25,375 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 21:04:25,376 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 21:04:25,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 21:04:25,411 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 21:04:25,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 21:04:25,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 21:04:25,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 21:04:25,442 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 21:04:25,442 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 21:04:25,444 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 21:04:25,444 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 21:04:25,445 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 21:04:25,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 21:04:25,446 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 21:04:25,446 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 21:04:25,449 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 21:04:25,449 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 21:04:25,450 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 21:04:25,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 21:04:25,450 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 21:04:25,450 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 21:04:25,451 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 21:04:25,451 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 21:04:25,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 21:04:25,452 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 21:04:25,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 21:04:25,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 21:04:25,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 21:04:25,455 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 21:04:25,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 21:04:25,456 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 21:04:25,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 21:04:25,456 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 21:04:25,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 21:04:25,457 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 21:04:25,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 21:04:25,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 21:04:25,459 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 21:04:25,459 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 21:04:25,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 21:04:25,460 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 21:04:25,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 21:04:25,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 21:04:25,476 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 21:04:25,476 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 21:04:25,479 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 21:04:25,480 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 21:04:25,483 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 21:04:25,484 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 21:04:25,484 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 21:04:25,486 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 21:04:25,499 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5725, Threshold=0.6335, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 21:04:25,499 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5725
